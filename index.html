<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechMart - Premium Tech at Budget Prices</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* Disable text selection for most elements */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* Disable drag and drop */
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }

        /* Allow text selection for input fields only */
        input, textarea, [contenteditable="true"] {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }

        /* Disable image drag */
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            pointer-events: none;
        }

        /* Disable highlighting */
        ::selection {
            background: transparent;
        }

        ::-moz-selection {
            background: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            color: #1e293b;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #475569;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            font-weight: 500;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            transition: width 0.3s ease;
        }

        .nav-links a:hover {
            color: #3b82f6;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .search-bar {
            display: flex;
            background: rgba(241, 245, 249, 0.8);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            margin: 0 2rem;
            min-width: 300px;
            border: 1px solid rgba(203, 213, 225, 0.5);
        }

        .search-bar input {
            background: none;
            border: none;
            color: #475569;
            flex: 1;
            padding: 0.5rem;
            outline: none;
        }

        .search-bar input::placeholder {
            color: rgba(71, 85, 105, 0.6);
        }

        .search-bar i {
            color: #64748b;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .user-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
            position: relative;
        }

        .cart-icon, .user-icon {
            position: relative;
            cursor: pointer;
            padding: 0.5rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 50%;
            transition: all 0.3s ease;
            color: #3b82f6;
        }

        .cart-icon:hover, .user-icon:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(203, 213, 225, 0.5);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            margin-top: 0.5rem;
        }

        .user-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-dropdown-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(203, 213, 225, 0.3);
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px 12px 0 0;
        }

        .user-dropdown-header .user-name {
            font-weight: 600;
            color: #1e293b;
            font-size: 0.9rem;
        }

        .user-dropdown-header .user-email {
            color: #64748b;
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .user-dropdown-menu {
            padding: 0.5rem 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: #374151;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .dropdown-item:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .dropdown-item i {
            width: 16px;
            font-size: 0.9rem;
        }

        .dropdown-item.danger:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            padding: 4rem 0;
            text-align: center;
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6, #10b981);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            color: #64748b;
            max-width: 600px;
            margin: 0 auto 2rem;
            line-height: 1.6;
        }

        /* Filters */
        .filters {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            border: 1px solid rgba(203, 213, 225, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-group label {
            color: #374151;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .filter-group select, .filter-group input {
            background: rgba(248, 250, 252, 0.9);
            border: 1px solid rgba(203, 213, 225, 0.8);
            color: #374151;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            outline: none;
            font-size: 0.9rem;
        }

        .filter-group select:focus, .filter-group input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .filter-group select option {
            background: #ffffff;
            color: #374151;
        }

        .btn {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            font-size: 0.95rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            background: linear-gradient(45deg, #2563eb, #1d4ed8);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #10b981, #059669);
        }

        .btn-secondary:hover {
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
            background: linear-gradient(45deg, #059669, #047857);
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        #products-section {
            height: 1px;
            margin-top: -1px;
        }

        .product-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(203, 213, 225, 0.5);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .product-card:hover::before {
            left: 100%;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border-color: rgba(59, 130, 246, 0.5);
        }

        .product-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 10px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ef4444;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #1e293b;
            min-height: 2.6rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.3;
        }

        .product-description {
            color: #64748b;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            line-height: 1.4;
            min-height: 2.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .price-current {
            font-size: 1.5rem;
            font-weight: 700;
            color: #059669;
        }

        .price-original {
            text-decoration: line-through;
            color: #9ca3af;
            font-size: 1rem;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            color: #fbbf24;
        }

        .product-rating span {
            color: #64748b;
            font-size: 0.9rem;
        }

        .product-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: auto;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            flex: 1;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            transition: right 0.3s ease;
            z-index: 2000;
            padding: 2rem;
            overflow-y: auto;
            border-left: 1px solid rgba(203, 213, 225, 0.5);
            box-shadow: -4px 0 6px -1px rgba(0, 0, 0, 0.1);
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(203, 213, 225, 0.5);
        }

        .cart-header h2 {
            color: #1e293b;
            font-weight: 600;
        }

        .cart-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 10px;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #f1f5f9, #e2e8f0);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #1e293b;
            font-size: 0.95rem;
        }

        .cart-item-price {
            color: #059669;
            font-weight: 600;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .quantity-btn {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #3b82f6;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: rgba(59, 130, 246, 0.2);
        }

        .cart-total {
            border-top: 1px solid rgba(203, 213, 225, 0.5);
            padding-top: 1rem;
            margin-top: 2rem;
        }

        .total-line {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .total-final {
            font-size: 1.2rem;
            font-weight: 600;
            color: #059669;
            border-top: 1px solid rgba(203, 213, 225, 0.5);
            padding-top: 0.5rem;
        }

        /* Auth Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .auth-modal {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.5rem;
            width: 90%;
            max-width: 380px;
            max-height: 85vh;
            overflow-y: auto;
            border: 1px solid rgba(203, 213, 225, 0.5);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .form-group {
            margin-bottom: 0.75rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.4rem;
            font-weight: 500;
            color: #374151;
            font-size: 0.9rem;
        }

        .form-group input {
            width: 100%;
            padding: 0.6rem;
            background: rgba(248, 250, 252, 0.8);
            border: 1px solid rgba(203, 213, 225, 0.8);
            border-radius: 8px;
            color: #374151;
            outline: none;
            font-size: 0.9rem;
        }

        .form-group input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-group input::placeholder {
            color: rgba(100, 116, 139, 0.6);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 2rem;
            border-radius: 8px;
            overflow: hidden;
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            background: rgba(248, 250, 252, 0.8);
            border: 1px solid rgba(203, 213, 225, 0.5);
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .auth-tab.active {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border-color: #3b82f6;
        }

        .auth-tab:hover:not(.active) {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 0.25rem;
            min-height: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .error-message:not(:empty) {
            animation: shake 0.3s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .validation-status {
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .validation-status.checking {
            color: #f59e0b;
        }

        .validation-status.valid {
            color: #10b981;
        }

        .validation-status.invalid {
            color: #ef4444;
        }

        .password-requirements {
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .requirement {
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
            transition: color 0.3s ease;
        }

        .requirement.valid {
            color: #10b981;
        }

        .requirement.invalid {
            color: #ef4444;
        }

        .requirement:last-child {
            margin-bottom: 0;
        }

        .btn-spinner {
            display: none;
        }

        .btn-spinner.active {
            display: inline-block;
        }

        .btn-text.hidden {
            display: none;
        }

        .form-group input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .form-group input.success {
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .form-group input.checking {
            border-color: #f59e0b;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }

        /* Product Detail Modal */
        .product-detail-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 5000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 2rem;
            overflow-y: auto;
        }

        .product-detail-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .product-detail-modal {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(203, 213, 225, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .product-detail-overlay.active .product-detail-modal {
            transform: scale(1);
        }

        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #64748b;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .modal-close-btn:hover {
            background: rgba(239, 68, 68, 0.9);
            color: white;
            transform: scale(1.1);
        }

        .product-detail-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            padding: 2rem;
        }

        .product-detail-left {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .product-detail-image {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .product-detail-image span {
            transition: transform 0.3s ease;
        }

        .product-detail-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ef4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .product-detail-gallery {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .gallery-thumb {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .gallery-thumb.active,
        .gallery-thumb:hover {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        }

        .product-detail-right {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .product-detail-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }

        .product-detail-rating {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: #64748b;
        }

        .product-detail-price {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(203, 213, 225, 0.3);
        }

        .product-detail-price .price-current {
            font-size: 2.5rem;
            font-weight: 700;
            color: #059669;
        }

        .product-detail-price .price-original {
            font-size: 1.5rem;
            text-decoration: line-through;
            color: #9ca3af;
        }

        .price-discount {
            background: #ef4444;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .product-detail-description,
        .product-detail-features,
        .product-detail-specs {
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(203, 213, 225, 0.3);
        }

        .product-detail-description h3,
        .product-detail-features h3,
        .product-detail-specs h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.75rem;
        }

        .product-detail-description p {
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }

        .product-detail-features ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .product-detail-features li {
            padding: 0.5rem 0;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .product-detail-features li::before {
            content: '✓';
            color: #10b981;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .specs-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .spec-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
        }

        .spec-label {
            color: #64748b;
            font-weight: 500;
        }

        .spec-value {
            color: #1e293b;
            font-weight: 600;
        }

        .product-detail-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 1.5rem 0;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quantity-selector label {
            font-weight: 600;
            color: #374151;
        }

        .quantity-controls-detail {
            display: flex;
            align-items: center;
            border: 1px solid rgba(203, 213, 225, 0.5);
            border-radius: 8px;
            overflow: hidden;
        }

        .quantity-controls-detail button {
            background: rgba(248, 250, 252, 0.8);
            border: none;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-weight: 600;
            color: #374151;
            transition: background 0.3s ease;
        }

        .quantity-controls-detail button:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .quantity-controls-detail input {
            width: 60px;
            height: 40px;
            border: none;
            text-align: center;
            font-weight: 600;
            color: #374151;
            background: white;
        }

        .btn-large {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .product-detail-info {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
            background: rgba(248, 250, 252, 0.5);
            border-radius: 10px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .info-item i {
            color: #3b82f6;
            font-size: 1.2rem;
            width: 24px;
        }

        .info-item div {
            display: flex;
            flex-direction: column;
        }

        .info-item strong {
            color:

#1e293b;
            font-weight: 600;
        }

        .info-item span {
            color: #64748b;
            font-size: 0.9rem;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Mobile Responsive for Product Detail */
        @media (max-width: 768px) {
            .product-detail-overlay {
                padding: 1rem;
            }

            .product-detail-content {
                grid-template-columns: 1fr;
                gap: 2rem;
                padding: 1.5rem;
            }

            .product-detail-image {
                height: 300px;
            }

            .product-detail-header h1 {
                font-size: 1.5rem;
            }

            .product-detail-price .price-current {
                font-size: 2rem;
            }

            .specs-grid {
                grid-template-columns: 1fr;
            }

            .quantity-selector {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .btn-large {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
            margin-bottom: 2rem;
        }

        .page-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(203, 213, 225, 0.5);
            color: #374151;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .page-btn:hover, .page-btn.active {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border-color: #3b82f6;
        }

        .hidden {
            display: none;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.5rem 0;
            }

            .nav-links {
                gap: 0.4rem;
                flex-wrap: wrap;
                justify-content: center;
                order: 3;
            }

            .nav-links a {
                padding: 0.3rem 0.6rem;
                min-height: 32px;
                display: flex;
                align-items: center;
                background: rgba(59, 130, 246, 0.1);
                border-radius: 5px;
                font-size: 0.8rem;
                transition: all 0.3s ease;
            }

            .nav-links a:hover {
                background: rgba(59, 130, 246, 0.2);
                transform: translateY(-1px);
            }

            .search-bar {
                margin: 0;
                min-width: 200px;
                max-width: 100%;
                order: 2;
                padding: 0.3rem 0.6rem;
            }

            .search-bar input {
                padding: 0.3rem;
                font-size: 0.85rem;
            }

            .user-actions {
                order: 1;
                align-self: flex-end;
                gap: 0.4rem;
            }

            .hero {
                padding: 1.5rem 0;
                margin-bottom: 1.5rem;
            }

            .hero h1 {
                font-size: 2rem;
                margin-bottom: 0.5rem;
            }

            .hero p {
                font-size: 0.95rem;
                padding: 0 0.75rem;
                margin-bottom: 1rem;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
                gap: 0.6rem;
                padding: 0.75rem;
                margin-bottom: 1.5rem;
            }

            .filter-group {
                flex-direction: column;
                align-items: stretch;
                gap: 0.3rem;
            }

            .filter-group label {
                font-size: 0.8rem;
            }

            .filter-group select, .filter-group input {
                width: 100%;
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .product-card {
                padding: 0.9rem;
                height: 100%;
            }

            .product-image {
                height: 150px;
            }

            .product-title {
                font-size: 0.95rem;
                min-height: 2.2rem;
            }

            .product-description {
                font-size: 0.8rem;
                min-height: 2.1rem;
            }

            .btn {
                padding: 0.45rem 0.9rem;
                font-size: 0.8rem;
            }

            .btn-small {
                padding: 0.35rem 0.7rem;
                font-size: 0.75rem;
            }

            .pagination {
                flex-wrap: wrap;
                gap: 0.25rem;
                margin-top: 1rem;
            }

            .page-btn {
                padding: 0.35rem 0.7rem;
                font-size: 0.8rem;
            }

            /* Touch-friendly improvements */
            .cart-icon, .user-icon {
                padding: 0.5rem;
                min-width: 36px;
                min-height: 36px;
            }

            .quantity-btn {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }

            .user-dropdown {
                right: -30px;
                min-width: 190px;
            }

            /* Product Detail Modal Mobile */
            .product-detail-overlay {
                padding: 0.6rem;
            }

            .product-detail-content {
                grid-template-columns: 1fr;
                gap: 1.25rem;
                padding: 1rem;
            }

            .product-detail-image {
                height: 220px;
            }

            .product-detail-header h1 {
                font-size: 1.3rem;
            }

            .product-detail-price .price-current {
                font-size: 1.7rem;
            }

            .specs-grid {
                grid-template-columns: 1fr;
            }

            .quantity-selector {
                flex-direction: column;
                align-items: stretch;
                gap: 0.4rem;
            }

            .btn-large {
                padding: 0.65rem 1.3rem;
                font-size: 0.9rem;
            }

            /* Mobile-specific improvements */
            .logo {
                font-size: 1.5rem;
            }

            .container {
                padding: 0 10px;
            }

            .header {
                padding: 0;
            }

            .nav {
                padding: 0.4rem 0;
            }
        }

        /* Tablet responsive */
        @media (max-width: 1024px) and (min-width: 769px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(290px, 1fr));
                gap: 1.5rem;
            }

            .search-bar {
                min-width: 250px;
            }

            .hero h1 {
                font-size: 3rem;
            }

            .filters {
                gap: 1rem;
            }

            .product-card {
                height: 100%;
            }

            .product-title {
                min-height: 2.6rem;
            }

            .product-description {
                min-height: 2.5rem;
            }
        }

        /* Large desktop */
        @media (min-width: 1400px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 2.5rem;
            }

            .hero h1 {
                font-size: 4rem;
            }

            .container {
                max-width: 1600px;
            }

            .product-card {
                height: 100%;
            }

            .product-title {
                min-height: 2.6rem;
            }

            .product-description {
                min-height: 2.5rem;
            }
        }

        /* Small mobile devices */
        @media (max-width: 480px) {
            .hero {
                padding: 1.2rem 0;
                margin-bottom: 1.2rem;
            }

            .hero h1 {
                font-size: 1.7rem;
                margin-bottom: 0.4rem;
            }

            .hero p {
                font-size: 0.85rem;
                padding: 0 0.5rem;
                margin-bottom: 0.8rem;
            }

            .products-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .nav {
                gap: 0.4rem;
                padding: 0.3rem 0;
            }

            .nav-links {
                gap: 0.2rem;
            }

            .nav-links a {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
                min-height: 28px;
            }

            .search-bar {
                min-width: 160px;
                padding: 0.25rem 0.5rem;
            }

            .search-bar input {
                padding: 0.25rem;
                font-size: 0.8rem;
            }

            .logo {
                font-size: 1.3rem;
            }

            .filters {
                padding: 0.6rem;
                gap: 0.5rem;
                margin-bottom: 1.2rem;
            }

            .filter-group label {
                font-size: 0.75rem;
            }

            .filter-group select, .filter-group input {
                padding: 0.35rem 0.5rem;
                font-size: 0.8rem;
            }

            .product-card {
                padding: 0.7rem;
                height: 100%;
            }

            .product-image {
                height: 140px;
            }

            .product-title {
                font-size: 0.9rem;
                min-height: 2rem;
            }

            .product-description {
                font-size: 0.75rem;
                min-height: 1.9rem;
            }

            .price-current {
                font-size: 1.1rem;
            }

            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.75rem;
            }

            .btn-small {
                padding: 0.3rem 0.6rem;
                font-size: 0.7rem;
            }

            .user-dropdown {
                right: -15px;
                min-width: 170px;
            }

            .modal-overlay {
                padding: 0.4rem;
            }

            .auth-modal, .settings-modal {
                padding: 0.8rem;
                max-width: 95%;
            }

            .cart-icon, .user-icon {
                padding: 0.4rem;
                min-width: 32px;
                min-height: 32px;
            }

            .user-actions {
                gap: 0.3rem;
            }

            .container {
                padding: 0 6px;
            }

            .pagination {
                gap: 0.2rem;
                margin-top: 0.8rem;
            }

            .page-btn {
                padding: 0.3rem 0.6rem;
                font-size: 0.75rem;
            }
        }

        /* Settings Modal */
        .settings-modal {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            border: 1px solid rgba(203, 213, 225, 0.5);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(203, 213, 225, 0.3);
        }

        .settings-header h2 {
            color: #1e293b;
            font-weight: 600;
            margin: 0;
        }

        .settings-tabs {
            display: flex;
            margin-bottom: 2rem;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(248, 250, 252, 0.8);
        }

        .settings-tab {
            flex: 1;
            padding: 0.75rem;
            text-align: center;
            border: 1px solid rgba(203, 213, 225, 0.5);
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9rem;
            background: none;
        }

        .settings-tab.active {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border-color: #3b82f6;
        }

        .settings-tab:hover:not(.active) {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .settings-content {
            display: none;
        }

        .settings-content.active {
            display: block;
        }

        .settings-section {
            margin-bottom: 1.5rem;
        }

        .settings-section h3 {
            color: #374151;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .danger-zone {
            background: rgba(239, 68, 68, 0.05);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 10px;
            padding: 1.5rem;
        }

        .danger-zone h3 {
            color: #ef4444;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .danger-zone p {
            color: #7f1d1d;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ef4444, #dc2626);
            color: white;
            border: none;
        }

        .btn-danger:hover {
            background: linear-gradient(45deg, #dc2626, #b91c1c);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }

        .current-info {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .current-info strong {
            color: #1e293b;
        }

        .current-info span {
            color: #64748b;
        }

        /* Security-specific styles to prevent screenshots */
        @media print {
            * {
                display: none !important;
            }
            body::before {
                content: "Printing disabled for security reasons";
                display: block !important;
                font-size: 24px;
                text-align: center;
                margin-top: 50px;
                color: #ef4444;
            }
        }

        /* Hide content during developer tools usage */
        .dev-tools-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            color: #fff;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            font-size: 18px;
            text-align: center;
            flex-direction: column;
            padding: 2rem;
        }

        .dev-tools-warning.active {
            display: flex !important;
            visibility: visible !important;
        }

        .dev-tools-warning h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #ef4444;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .dev-tools-warning p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            max-width: 600px;
        }

        /* Protect against screenshot tools */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            pointer-events: none;
            z-index: -1;
        }
    </style>
</head>
<body>
    <!-- Developer Tools Warning -->
    <div class="dev-tools-warning" id="devToolsWarning">
        <h2>🛡️ Content Protected</h2>
        <p>Developer tools have been detected and content is temporarily hidden for security.</p>
        <p><strong>Close developer tools to continue browsing the website.</strong></p>
        <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px;">
            <p style="font-size: 0.9rem; opacity: 0.8;">
                This protection helps safeguard our website code and content while allowing normal usage.
            </p>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="#" class="logo">TechMart</a>
                
                <div class="search-bar">
                    <input type="text" placeholder="Search 100+ budget tech products..." id="searchInput">
                    <i class="fas fa-search"></i>
                </div>

                <ul class="nav-links">
                    <li><a href="#" onclick="filterByCategory('all')">All Products</a></li>
                    <li><a href="#" onclick="filterByCategory('smartphones')">Phones</a></li>
                    <li><a href="#" onclick="filterByCategory('laptops')">Laptops</a></li>
                    <li><a href="#" onclick="filterByCategory('accessories')">Accessories</a></li>
                    <li><a href="#" onclick="filterByCategory('audio')">Audio</a></li>
                </ul>

                <div class="user-actions">
                    <div class="user-icon" onclick="toggleUserDropdown()">
                        <i class="fas fa-user"></i>
                        <div class="user-dropdown" id="userDropdown">
                            <div class="user-dropdown-header">
                                <div class="user-name">Guest User</div>
                                <div class="user-email">Please login</div>
                            </div>
                            <div class="user-dropdown-menu">
                                <div class="dropdown-item" onclick="openAuthModal()">
                                    <i class="fas fa-sign-in-alt"></i>
                                    <span>Login / Register</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cart-icon" onclick="toggleCart()">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Premium Tech at Budget Prices</h1>
            <p>Discover 100 handpicked, tested, and affordable tech products that deliver exceptional value without breaking the bank</p>
            <button class="btn" onclick="scrollToProducts()">Explore Products</button>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Filters -->
        <div class="filters">
            <div class="filter-group">
                <label>Category:</label>
                <select id="categoryFilter">
                    <option value="all">All Categories</option>
                    <option value="smartphones">Smartphones</option>
                    <option value="laptops">Laptops</option>
                    <option value="tablets">Tablets</option>
                    <option value="audio">Audio</option>
                    <option value="accessories">Accessories</option>
                    <option value="gaming">Gaming</option>
                    <option value="smart-home">Smart Home</option>
                    <option value="wearables">Wearables</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Price Range:</label>
                <select id="priceFilter">
                    <option value="all">All Prices</option>
                    <option value="0-25">Under $25</option>
                    <option value="25-50">$25 - $50</option>
                    <option value="50-100">$50 - $100</option>
                    <option value="100-200">$100 - $200</option>
                    <option value="200+">$200+</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Sort by:</label>
                <select id="sortFilter">
                    <option value="featured">Featured</option>
                    <option value="price-low">Price: Low to High</option>
                    <option value="price-high">Price: High to Low</option>
                    <option value="rating">Highest Rated</option>
                    <option value="newest">Newest</option>
                </select>
            </div>
            <button class="btn" onclick="applyFilters()">Apply Filters</button>
            <button class="btn btn-secondary" onclick="resetFilters()">Reset</button>
        </div>

        <!-- Products Grid -->
        <div id="products-section"></div>
        <div class="products-grid" id="productsGrid">
            <!-- Products will be dynamically loaded here -->
        </div>

        <!-- Pagination -->
        <div class="pagination" id="pagination">
            <!-- Pagination will be dynamically loaded here -->
        </div>
    </main>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h2>Shopping Cart</h2>
            <button onclick="toggleCart()" style="background: none; border: none; color: #64748b; font-size: 1.5rem; cursor: pointer; transition: color 0.3s ease;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div id="cartItems">
            <!-- Cart items will be dynamically loaded here -->
        </div>
        <div class="cart-total">
            <div class="total-line">
                <span>Subtotal:</span>
                <span id="subtotal">$0.00</span>
            </div>
            <div class="total-line">
                <span>Shipping:</span>
                <span id="shipping">Free</span>
            </div>
            <div class="total-line">
                <span>Tax:</span>
                <span id="tax">$0.00</span>
            </div>
            <div class="total-line total-final">
                <span>Total:</span>
                <span id="total">$0.00</span>
            </div>
            <button class="btn" style="width: 100%; margin-top: 1rem;" onclick="proceedToCheckout()">
                Proceed to Checkout
            </button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="authModal">
        <div class="auth-modal">
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" name="email" placeholder="Enter your email" required>
                    <div class="error-message" id="loginEmailError"></div>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" name="password" placeholder="Enter your password" required>
                    <div class="error-message" id="loginPasswordError"></div>
                </div>
                <div class="error-message" id="loginError"></div>
                <button type="submit" class="btn" style="width: 100%;">
                    <span class="btn-text">Login</span>
                    <div class="btn-spinner hidden">
                        <i class="fas fa-spinner fa-spin"></i>
                    </div>
                </button>
            </form>

            <form id="registerForm" class="hidden">
                <div class="form-group">
                    <label>Full Name:</label>
                    <input type="text" name="fullName" placeholder="Enter your full name" required>
                    <div class="error-message" id="registerNameError"></div>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" name="email" placeholder="Enter your email" required>
                    <div class="error-message" id="registerEmailError"></div>
                    <div class="validation-status" id="emailValidationStatus"></div>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" name="password" placeholder="Create a password" required>
                    <div class="error-message" id="registerPasswordError"></div>
                    <div class="password-requirements" id="passwordRequirements">
                        <div class="requirement" id="req-length">✗ At least 8 characters</div>
                        <div class="requirement" id="req-upper">✗ One uppercase letter</div>
                        <div class="requirement" id="req-lower">✗ One lowercase letter</div>
                        <div class="requirement" id="req-number">✗ One number</div>
                        <div class="requirement" id="req-special">✗ One special character</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Confirm Password:</label>
                    <input type="password" name="confirmPassword" placeholder="Confirm your password" required>
                    <div class="error-message" id="registerConfirmPasswordError"></div>
                </div>
                <div class="error-message" id="registerError"></div>
                <button type="submit" class="btn" style="width: 100%;">
                    <span class="btn-text">Register</span>
                    <div class="btn-spinner hidden">
                        <i class="fas fa-spinner fa-spin"></i>
                    </div>
                </button>
            </form>

            <button onclick="closeAuthModal()" style="background: none; border: none; color: #64748b; margin-top: 1rem; cursor: pointer; font-size: 0.9rem; transition: color 0.3s ease;">
                Close
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="settings-modal">
            <div class="settings-header">
                <h2>Account Settings</h2>
                <button onclick="closeSettingsModal()" style="background: none; border: none; color: #64748b; font-size: 1.5rem; cursor: pointer; transition: color 0.3s ease;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="settings-tabs">
                <button class="settings-tab active" onclick="switchSettingsTab('account')">Account</button>
                <button class="settings-tab" onclick="switchSettingsTab('security')">Security</button>
                <button class="settings-tab" onclick="switchSettingsTab('danger')">Delete Account</button>
            </div>
            
            <!-- Account Settings -->
            <div id="accountSettings" class="settings-content active">
                <div class="settings-section">
                    <h3>Change Email Address</h3>
                    <div class="current-info">
                        <strong>Current Email:</strong> <span id="currentEmailDisplay">user@example.com</span>
                    </div>
                    <form id="changeEmailForm">
                        <div class="form-group">
                            <label>New Email Address:</label>
                            <input type="email" name="newEmail" placeholder="Enter new email address" required>
                            <div class="error-message" id="changeEmailError"></div>
                            <div class="validation-status" id="newEmailValidationStatus"></div>
                        </div>
                        <div class="form-group">
                            <label>Current Password:</label>
                            <input type="password" name="currentPassword" placeholder="Enter your current password" required>
                            <div class="error-message" id="currentPasswordError"></div>
                        </div>
                        <button type="submit" class="btn" style="width: 100%;">
                            <span class="btn-text">Update Email</span>
                            <div class="btn-spinner hidden">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Security Settings -->
            <div id="securitySettings" class="settings-content">
                <div class="settings-section">
                    <h3>Change Password</h3>
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label>Current Password:</label>
                            <input type="password" name="currentPassword" placeholder="Enter your current password" required>
                            <div class="error-message" id="currentPasswordChangeError"></div>
                        </div>
                        <div class="form-group">
                            <label>New Password:</label>
                            <input type="password" name="newPassword" placeholder="Enter new password" required>
                            <div class="error-message" id="newPasswordError"></div>
                            <div class="password-requirements" id="newPasswordRequirements">
                                <div class="requirement" id="new-req-length">✗ At least 8 characters</div>
                                <div class="requirement" id="new-req-upper">✗ One uppercase letter</div>
                                <div class="requirement" id="new-req-lower">✗ One lowercase letter</div>
                                <div class="requirement" id="new-req-number">✗ One number</div>
                                <div class="requirement" id="new-req-special">✗ One special character</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Confirm New Password:</label>
                            <input type="password" name="confirmNewPassword" placeholder="Confirm new password" required>
                            <div class="error-message" id="confirmNewPasswordError"></div>
                        </div>
                        <button type="submit" class="btn" style="width: 100%;">
                            <span class="btn-text">Change Password</span>
                            <div class="btn-spinner hidden">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Danger Zone -->
            <div id="dangerSettings" class="settings-content">
                <div class="danger-zone">
                    <h3><i class="fas fa-exclamation-triangle"></i> Danger Zone</h3>
                    <p>Once you delete your account, there is no going back. Please be certain.</p>
                    <form id="deleteAccountForm">
                        <div class="form-group">
                            <label>Type "DELETE" to confirm:</label>
                            <input type="text" name="confirmDelete" placeholder="Type DELETE to confirm" required>
                            <div class="error-message" id="deleteConfirmError"></div>
                        </div>
                        <div class="form-group">
                            <label>Enter your password:</label>
                            <input type="password" name="deletePassword" placeholder="Enter your password" required>
                            <div class="error-message" id="deletePasswordError"></div>
                        </div>
                        <button type="submit" class="btn btn-danger" style="width: 100%;">
                            <span class="btn-text">Delete Account Permanently</span>
                            <div class="btn-spinner hidden">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================================================
        // SECURITY PROTECTION FUNCTIONS
        // =============================================================================
        
        // Security object to manage all protection features
        const SecurityManager = {
            isDevToolsOpen: false,
            warningShown: false,
            
            // Initialize all security measures
            init() {
                this.disableRightClick();
                this.disableKeyboardShortcuts();
                this.preventTextSelection();
                this.disableDragAndDrop();
                this.detectDevTools();
                this.disablePrint();
                this.preventInspection();
                this.clearConsole();
                this.disableSelectAll();
                this.protectImages();
                
                console.log('%c🛡️ Security Protection Active', 'color: #ef4444; font-size: 20px; font-weight: bold;');
                console.log('%c⚠️ Developer tools detection enabled - content will be hidden if dev tools are opened', 'color: #f59e0b; font-size: 14px;');
                console.log('%c📋 Website content and code are protected from unauthorized access', 'color: #3b82f6; font-size: 12px;');
                
                // Clear console every 3 seconds (less frequent to reduce performance impact)
                setInterval(() => this.clearConsole(), 3000);
            },
            
            // Disable right-click context menu
            disableRightClick() {
                document.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this.showSecurityAlert('Right-click is disabled for security purposes');
                    return false;
                }, true);
            },
            
            // Disable common keyboard shortcuts
            disableKeyboardShortcuts() {
                const blockedKeys = [
                    'F12', // Developer Tools
                    'F11', // Fullscreen (can be used to hide devtools)
                    'F10', // Menu
                    'F5',  // Refresh (with Ctrl)
                    'F3',  // Find (with Ctrl)
                    'I',   // Developer Tools (Ctrl+Shift+I)
                    'J',   // Console (Ctrl+Shift+J)
                    'C',   // Console (Ctrl+Shift+C)
                    'U',   // View Source (Ctrl+U)
                    'S',   // Save Page (Ctrl+S)
                    'A',   // Select All (Ctrl+A)
                    'P',   // Print (Ctrl+P)
                    'R',   // Refresh (Ctrl+R)
                    'H',   // History (Ctrl+H)
                    'D',   // Bookmark (Ctrl+D)
                    'G',   // Find Next (Ctrl+G)
                    'F',   // Find (Ctrl+F)
                    'N',   // New Window (Ctrl+N)
                    'T',   // New Tab (Ctrl+T)
                    'W',   // Close Tab (Ctrl+W)
                    'Z',   // Undo (Ctrl+Z)
                    'Y',   // Redo (Ctrl+Y)
                    'X',   // Cut (Ctrl+X)
                    'V',   // Paste (Ctrl+V) - except in input fields
                ];
                
                document.addEventListener('keydown', (e) => {
                    // Allow normal typing in input fields
                    const isInputField = e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.contentEditable === 'true';
                    
                    // Block F12 and other function keys
                    if (e.key === 'F12' || e.key === 'F11' || e.key === 'F10') {
                        e.preventDefault();
                        e.stopPropagation();
                        this.showSecurityAlert('Function keys are disabled for security');
                        return false;
                    }
                    
                    // Block Ctrl combinations
                    if (e.ctrlKey) {
                        const key = e.key.toLowerCase();
                        if (blockedKeys.includes(key.toUpperCase()) || blockedKeys.includes(key)) {
                            // Allow Ctrl+V, Ctrl+C, Ctrl+X only in input fields
                            if (isInputField && (key === 'v' || key === 'c' || key === 'x' || key === 'a')) {
                                return true;
                            }
                            e.preventDefault();
                            e.stopPropagation();
                            this.showSecurityAlert('This keyboard shortcut is disabled');
                            return false;
                        }
                    }
                    
                    // Block Ctrl+Shift combinations
                    if (e.ctrlKey && e.shiftKey) {
                        const key = e.key.toLowerCase();
                        if (['i', 'j', 'c'].includes(key)) {
                            e.preventDefault();
                            e.stopPropagation();
                            this.showSecurityAlert('Developer shortcuts are disabled');
                            return false;
                        }
                    }
                    
                    // Block Alt+Tab (can be used to switch to devtools)
                    if (e.altKey && e.key === 'Tab') {
                        e.preventDefault();
                        e.stopPropagation();
                        return false;
                    }
                }, true);
            },
            
            // Prevent text selection (except in input fields)
            preventTextSelection() {
                document.addEventListener('selectstart', (e) => {
                    const isInputField = e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.contentEditable === 'true';
                    if (!isInputField) {
                        e.preventDefault();
                        return false;
                    }
                }, true);
            },
            
            // Disable drag and drop
            disableDragAndDrop() {
                document.addEventListener('dragstart', (e) => {
                    e.preventDefault();
                    return false;
                }, true);
                
                document.addEventListener('drop', (e) => {
                    e.preventDefault();
                    return false;
                }, true);
            },
            
            // Detect developer tools
            detectDevTools() {
                let devtools = false;
                let lastCheck = Date.now();
                
                // Method 1: Check window dimensions (more conservative thresholds)
                const checkDimensions = () => {
                    // More conservative thresholds to avoid false positives
                    const heightThreshold = 300;
                    const widthThreshold = 300;
                    
                    const heightDiff = window.outerHeight - window.innerHeight;
                    const widthDiff = window.outerWidth - window.innerWidth;
                    
                    // Check if the difference is significantly larger than normal browser chrome
                    return heightDiff > heightThreshold || widthDiff > widthThreshold;
                };
                
                // Check dimensions less frequently to avoid false positives
                setInterval(() => {
                    const dimensionCheck = checkDimensions();
                    const now = Date.now();
                    
                    if (dimensionCheck) {
                        if (!devtools) {
                            devtools = true;
                            this.handleDevToolsOpen();
                        }
                        lastCheck = now;
                    } else {
                        // Only close if tools have been closed for a reasonable time
                        if (devtools && (now - lastCheck > 2000)) {
                            devtools = false;
                            this.handleDevToolsClose();
                        }
                    }
                }, 1000); // Less frequent checks to reduce false positives
                
                // Method 2: Console detection (less aggressive)
                let element = new Image();
                let consoleAccessCount = 0;
                element.__defineGetter__('id', () => {
                    consoleAccessCount++;
                    // Only trigger after multiple console accesses to avoid false positives
                    if (consoleAccessCount > 2 && !this.isDevToolsOpen) {
                        this.handleDevToolsOpen();
                    }
                });
                
                setInterval(() => {
                    console.clear();
                    console.log(element);
                    
                    // Reset counter periodically
                    if (consoleAccessCount > 0) {
                        consoleAccessCount--;
                    }
                }, 2000); // Less frequent
                
                // Method 3: Check for known dev tools (only if they exist)
                setInterval(() => {
                    if (typeof window.Firebug !== 'undefined' && 
                        window.Firebug && 
                        window.Firebug.chrome && 
                        window.Firebug.chrome.isInitialized) {
                        if (!this.isDevToolsOpen) {
                            this.handleDevToolsOpen();
                        }
                    }
                }, 2000);
            },
            
            // Handle developer tools opening
            handleDevToolsOpen() {
                if (!this.isDevToolsOpen) {
                    this.isDevToolsOpen = true;
                    const warning = document.getElementById('devToolsWarning');
                    warning.classList.add('active');
                    
                    // Hide main content (but keep warning visible)
                    const mainElements = document.querySelectorAll('body > *:not(.dev-tools-warning)');
                    mainElements.forEach(element => {
                        element.style.display = 'none';
                    });
                    
                    console.clear();
                    console.log('%c🛡️ Content Hidden - Developer Tools Detected', 'color: #ef4444; font-size: 16px; font-weight: bold;');
                    console.log('%c⚠️ Close developer tools to continue browsing', 'color: #f59e0b; font-size: 14px;');
                }
            },
            
            // Handle developer tools closing
            handleDevToolsClose() {
                if (this.isDevToolsOpen) {
                    // Double-check that tools are really closed with more conservative thresholds
                    setTimeout(() => {
                        const heightDiff = window.outerHeight - window.innerHeight;
                        const widthDiff = window.outerWidth - window.innerWidth;
                        
                        // Use conservative thresholds - only restore if clearly closed
                        if (heightDiff <= 250 && widthDiff <= 250) {
                            this.isDevToolsOpen = false;
                            const warning = document.getElementById('devToolsWarning');
                            warning.classList.remove('active');
                            
                            // Restore main content visibility
                            const mainElements = document.querySelectorAll('body > *:not(.dev-tools-warning)');
                            mainElements.forEach(element => {
                                element.style.display = '';
                            });
                            
                            console.clear();
                            console.log('%c🛡️ Content Restored - Developer Tools Closed', 'color: #10b981; font-size: 16px; font-weight: bold;');
                        }
                    }, 1000); // Longer delay to ensure tools are fully closed
                }
            },
            
            // Disable print functionality
            disablePrint() {
                window.addEventListener('beforeprint', (e) => {
                    e.preventDefault();
                    this.showSecurityAlert('Printing is disabled for security purposes');
                    return false;
                });
                
                // Override print function
                window.print = () => {
                    this.showSecurityAlert('Printing is disabled for security purposes');
                };
            },
            
            // Prevent inspection methods
            preventInspection() {
                // Disable view source
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 'u') {
                        e.preventDefault();
                        this.showSecurityAlert('View source is disabled');
                        return false;
                    }
                });
                
                // Disable save page
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 's') {
                        e.preventDefault();
                        this.showSecurityAlert('Save page is disabled');
                        return false;
                    }
                });
            },
            
            // Clear console periodically
            clearConsole() {
                try {
                    console.clear();
                    console.log('%c🛡️ Console cleared for security', 'color: #ef4444; font-size: 12px;');
                } catch (e) {
                    // Ignore errors
                }
            },
            
            // Disable select all
            disableSelectAll() {
                document.addEventListener('keydown', (e) => {
                    const isInputField = e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.contentEditable === 'true';
                    if (e.ctrlKey && e.key === 'a' && !isInputField) {
                        e.preventDefault();
                        this.showSecurityAlert('Select all is disabled');
                        return false;
                    }
                });
            },
            
            // Protect images from saving
            protectImages() {
                document.querySelectorAll('img').forEach(img => {
                    img.addEventListener('dragstart', (e) => {
                        e.preventDefault();
                        return false;
                    });
                    
                    img.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        this.showSecurityAlert('Image protection active');
                        return false;
                    });
                });
            },
            
            // Show security alert
            showSecurityAlert(message) {
                if (!this.warningShown) {
                    this.warningShown = true;
                    setTimeout(() => this.warningShown = false, 2000);
                    
                    // Create temporary alert
                    const alert = document.createElement('div');
                    alert.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #ef4444;
                        color: white;
                        padding: 1rem;
                        border-radius: 8px;
                        z-index: 10000;
                        font-weight: 600;
                        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                        max-width: 300px;
                    `;
                    alert.textContent = message;
                    document.body.appendChild(alert);
                    
                    setTimeout(() => {
                        if (document.body.contains(alert)) {
                            document.body.removeChild(alert);
                        }
                    }, 3000);
                }
            }
        };
        
        // Initialize security when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            SecurityManager.init();
        });
        
        // =============================================================================
        // ORIGINAL WEBSITE FUNCTIONALITY (UNCHANGED)
        // =============================================================================
        
        // Product Data (100 Budget Tech Products)
        const products = [
            // Smartphones (15 products)
            { id: 1, name: "Samsung Galaxy A54 5G", category: "smartphones", price: 199, originalPrice: 249, rating: 4.5, badge: "Best Seller", description: "5G smartphone with 50MP camera and 120Hz display", icon: "📱" },
            { id: 2, name: "Google Pixel 7a", category: "smartphones", price: 179, originalPrice: 229, rating: 4.6, badge: "Editor's Choice", description: "Pure Android experience with excellent camera", icon: "📱" },
            { id: 3, name: "OnePlus Nord N30 5G", category: "smartphones", price: 149, originalPrice: 199, rating: 4.3, badge: "Value Pick", description: "Fast charging and smooth performance", icon: "📱" },
            { id: 4, name: "Motorola Moto G Power", category: "smartphones", price: 129, originalPrice: 179, rating: 4.2, badge: "Long Battery", description: "3-day battery life guaranteed", icon: "📱" },
            { id: 5, name: "iPhone SE (3rd Gen)", category: "smartphones", price: 199, originalPrice: 249, rating: 4.4, badge: "iOS Budget", description: "A15 Bionic chip in compact design", icon: "📱" },
            { id: 6, name: "Xiaomi Redmi Note 12", category: "smartphones", price: 139, originalPrice: 189, rating: 4.3, badge: "Value", description: "50MP camera with fast charging", icon: "📱" },
            { id: 7, name: "TCL 30 5G", category: "smartphones", price: 119, originalPrice: 159, rating: 4.1, badge: "Budget 5G", description: "Affordable 5G with decent performance", icon: "📱" },
            { id: 8, name: "Nokia G400 5G", category: "smartphones", price: 159, originalPrice: 199, rating: 4.2, badge: "Durable", description: "2-day battery with clean Android", icon: "📱" },
            { id: 9, name: "Samsung Galaxy A24", category: "smartphones", price: 109, originalPrice: 149, rating: 4.0, badge: "Budget", description: "Triple camera system", icon: "📱" },
            { id: 10, name: "Motorola Edge 30", category: "smartphones", price: 189, originalPrice: 239, rating: 4.4, badge: "Fast", description: "144Hz display with wireless charging", icon: "📱" },
            { id: 11, name: "Google Pixel 6a", category: "smartphones", price: 169, originalPrice: 219, rating: 4.5, badge: "Camera", description: "Google Tensor chip with excellent photos", icon: "📱" },
            { id: 12, name: "OnePlus Nord CE 3", category: "smartphones", price: 179, originalPrice: 229, rating: 4.3, badge: "Fast Charge", description: "80W SuperVOOC charging", icon: "📱" },
            { id: 13, name: "Realme GT Neo 3", category: "smartphones", price: 159, originalPrice: 209, rating: 4.2, badge: "Gaming", description: "MediaTek Dimensity 8100", icon: "📱" },
            { id: 14, name: "Honor X9a", category: "smartphones", price: 149, originalPrice: 199, rating: 4.1, badge: "Curved Display", description: "6.67-inch curved OLED display", icon: "📱" },
            { id: 15, name: "Vivo Y36", category: "smartphones", price: 129, originalPrice: 169, rating: 4.0, badge: "Selfie", description: "50MP front camera for perfect selfies", icon: "📱" },

            // Laptops (15 products)
            { id: 16, name: "ASUS VivoBook 15", category: "laptops", price: 399, originalPrice: 499, rating: 4.3, badge: "Student Pick", description: "Intel i5, 8GB RAM, 256GB SSD", icon: "💻" },
            { id: 17, name: "Acer Aspire 5", category: "laptops", price: 449, originalPrice: 549, rating: 4.4, badge: "Best Value", description: "AMD Ryzen 5, 8GB RAM, 512GB SSD", icon: "💻" },
            { id: 18, name: "HP Pavilion 15", category: "laptops", price: 479, originalPrice: 579, rating: 4.2, badge: "Reliable", description: "Intel i5, 16GB RAM, 256GB SSD", icon: "💻" },
            { id: 19, name: "Lenovo IdeaPad 3", category: "laptops", price: 379, originalPrice: 449, rating: 4.1, badge: "Budget", description: "AMD Ryzen 3, 8GB RAM, 256GB SSD", icon: "💻" },
            { id: 20, name: "Dell Inspiron 15 3000", category: "laptops", price: 429, originalPrice: 529, rating: 4.0, badge: "Office", description: "Intel i3, 8GB RAM, 256GB SSD", icon: "💻" },
            { id: 21, name: "ASUS TUF Gaming A15", category: "laptops", price: 599, originalPrice: 699, rating: 4.5, badge: "Gaming", description: "AMD Ryzen 5, GTX 1650, 8GB RAM", icon: "💻" },
            { id: 22, name: "HP Envy x360", category: "laptops", price: 549, originalPrice: 649, rating: 4.4, badge: "2-in-1", description: "Convertible laptop with touchscreen", icon: "💻" },
            { id: 23, name: "Acer Chromebook Spin 514", category: "laptops", price: 349, originalPrice: 399, rating: 4.2, badge: "Chrome OS", description: "AMD Ryzen 3, 8GB RAM, 128GB eMMC", icon: "💻" },
            { id: 24, name: "Lenovo ThinkPad E15", category: "laptops", price: 519, originalPrice: 619, rating: 4.3, badge: "Business", description: "Intel i5, 8GB RAM, 256GB SSD", icon: "💻" },
            { id: 25, name: "MSI Modern 14", category: "laptops", price: 459, originalPrice: 559, rating: 4.1, badge: "Lightweight", description: "Intel i5, 8GB RAM, 512GB SSD", icon: "💻" },
            { id: 26, name: "ASUS ZenBook 14", category: "laptops", price: 589, originalPrice: 689, rating: 4.6, badge: "Premium", description: "Intel i7, 16GB RAM, 512GB SSD", icon: "💻" },
            { id: 27, name: "HP 14 Laptop", category: "laptops", price: 299, originalPrice: 379, rating: 3.9, badge: "Ultra Budget", description: "Intel Celeron, 4GB RAM, 64GB eMMC", icon: "💻" },
            { id: 28, name: "Acer Nitro 5", category: "laptops", price: 629, originalPrice: 729, rating: 4.3, badge: "Gaming", description: "Intel i5, GTX 1650, 8GB RAM", icon: "💻" },
            { id: 29, name: "Lenovo Yoga 7i", category: "laptops", price: 649, originalPrice: 749, rating: 4.5, badge: "Convertible", description: "Intel i5, 16GB RAM, 512GB SSD", icon: "💻" },
            { id: 30, name: "Dell XPS 13", category: "laptops", price: 699, originalPrice: 799, rating: 4.7, badge: "Ultrabook", description: "Intel i5, 8GB RAM, 256GB SSD", icon: "💻" },

            // Tablets (10 products)
            { id: 31, name: "iPad (10th Gen)", category: "tablets", price: 299, originalPrice: 349, rating: 4.6, badge: "Apple", description: "A14 Bionic chip with 10.9-inch display", icon: "📱" },
            { id: 32, name: "Samsung Galaxy Tab A8", category: "tablets", price: 179, originalPrice: 229, rating: 4.2, badge: "Android", description: "10.5-inch display with quad speakers", icon: "📱" },
            { id: 33, name: "Amazon Fire HD 10", category: "tablets", price: 89, originalPrice: 149, rating: 4.0, badge: "Budget", description: "10.1-inch Full HD display", icon: "📱" },
            { id: 34, name: "Lenovo Tab M10 Plus", category: "tablets", price: 139, originalPrice: 189, rating: 4.1, badge: "Family", description: "MediaTek Helio G80 processor", icon: "📱" },
            { id: 35, name: "Microsoft Surface Go 3", category: "tablets", price: 399, originalPrice: 499, rating: 4.3, badge: "Windows", description: "Intel Pentium Gold with Windows 11", icon: "📱" },
            { id: 36, name: "ASUS ZenPad 3S 10", category: "tablets", price: 199, originalPrice: 249, rating: 4.0, badge: "Entertainment", description: "9.7-inch 2K display", icon: "📱" },
            { id: 37, name: "Huawei MatePad SE", category: "tablets", price: 159, originalPrice: 199, rating: 3.9, badge: "Kids", description: "10.4-inch with parental controls", icon: "📱" },
            { id: 38, name: "TCL TAB 10s", category: "tablets", price: 119, originalPrice: 169, rating: 3.8, badge: "Basic", description: "10.1-inch Android tablet", icon: "📱" },
            { id: 39, name: "iPad mini (6th Gen)", category: "tablets", price: 399, originalPrice: 499, rating: 4.7, badge: "Compact", description: "A15 Bionic chip in 8.3-inch design", icon: "📱" },
            { id: 40, name: "Samsung Galaxy Tab S6 Lite", category: "tablets", price: 249, originalPrice: 299, rating: 4.4, badge: "S Pen", description: "Includes S Pen for drawing and notes", icon: "📱" },

            // Audio (15 products)
            { id: 41, name: "Sony WH-CH720N", category: "audio", price: 89, originalPrice: 149, rating: 4.4, badge: "Noise Cancel", description: "Wireless noise canceling headphones", icon: "🎧" },
            { id: 42, name: "JBL Tune 760NC", category: "audio", price: 79, originalPrice: 129, rating: 4.2, badge: "JBL Sound", description: "Active noise cancelling", icon: "🎧" },
            { id: 43, name: "Anker Soundcore Life Q30", category: "audio", price: 59, originalPrice: 79, rating: 4.5, badge: "Value", description: "40-hour playtime with ANC", icon: "🎧" },
            { id: 44, name: "Skullcandy Crusher ANC", category: "audio", price: 149, originalPrice: 199, rating: 4.3, badge: "Bass", description: "Sensory bass and ANC", icon: "🎧" },
            { id: 45, name: "Audio-Technica ATH-M40x", category: "audio", price: 99, originalPrice: 149, rating: 4.6, badge: "Studio", description: "Professional monitor headphones", icon: "🎧" },
            { id: 46, name: "Samsung Galaxy Buds2", category: "audio", price: 89, originalPrice: 149, rating: 4.3, badge: "True Wireless", description: "ANC earbuds with 360 Audio", icon: "🎧" },
            { id: 47, name: "Jabra Elite 3", category: "audio", price: 49, originalPrice: 79, rating: 4.1, badge: "Calls", description: "Clear calls and rich music", icon: "🎧" },
            { id: 48, name: "Sennheiser HD 559", category: "audio", price: 119, originalPrice: 199, rating: 4.5, badge: "Open-back", description: "Open-back over-ear headphones", icon: "🎧" },
            { id: 49, name: "Beats Solo3 Wireless", category: "audio", price: 129, originalPrice: 199, rating: 4.2, badge: "Apple W1", description: "40-hour battery life", icon: "🎧" },
            { id: 50, name: "Anker Soundcore Liberty 3 Pro", category: "audio", price: 79, originalPrice: 129, rating: 4.4, badge: "LDAC", description: "Hi-Res audio with ANC", icon: "🎧" },
            { id: 51, name: "1MORE SonoFlow", category: "audio", price: 69, originalPrice: 99, rating: 4.3, badge: "Hi-Res", description: "40mm drivers with Hi-Res Audio", icon: "🎧" },
            { id: 52, name: "JLab Audio Epic Air Sport", category: "audio", price: 59, originalPrice: 99, rating: 4.1, badge: "Fitness", description: "Sports earbuds with 70+ hour battery", icon: "🎧" },
            { id: 53, name: "Philips SHP9500", category: "audio", price: 69, originalPrice: 99, rating: 4.4, badge: "Gaming", description: "Open-back for gaming and music", icon: "🎧" },
            { id: 54, name: "Tribit XSound Go", category: "audio", price: 29, originalPrice: 49, rating: 4.2, badge: "Portable", description: "Bluetooth speaker with 24H playtime", icon: "🔊" },
            { id: 55, name: "JBL Clip 4", category: "audio", price: 39, originalPrice: 59, rating: 4.0, badge: "Compact", description: "Ultra-portable speaker with carabiner", icon: "🔊" },

            // Accessories (20 products)
            { id: 56, name: "Anker PowerCore 10000", category: "accessories", price: 29, originalPrice: 39, rating: 4.6, badge: "Fast Charge", description: "10000mAh portable charger", icon: "🔋" },
            { id: 57, name: "Logitech MX Master 3S", category: "accessories", price: 79, originalPrice: 99, rating: 4.7, badge: "Productivity", description: "Advanced wireless mouse", icon: "🖱️" },
            { id: 58, name: "Razer DeathAdder V3", category: "accessories", price: 59, originalPrice: 69, rating: 4.5, badge: "Gaming", description: "Ergonomic gaming mouse", icon: "🖱️" },
            { id: 59, name: "Keychron K2", category: "accessories", price: 69, originalPrice: 89, rating: 4.4, badge: "Mechanical", description: "Wireless mechanical keyboard", icon: "⌨️" },
            { id: 60, name: "Apple MagSafe Charger", category: "accessories", price: 29, originalPrice: 39, rating: 4.3, badge: "Wireless", description: "15W wireless charging for iPhone", icon: "🔌" },
            { id: 61, name: "SanDisk Ultra 128GB", category: "accessories", price: 19, originalPrice: 29, rating: 4.5, badge: "Storage", description: "High-speed USB 3.0 flash drive", icon: "💾" },
            { id: 62, name: "Belkin 3-in-1 Wireless Charger", category: "accessories", price: 89, originalPrice: 129, rating: 4.2, badge: "MagSafe", description: "Charge iPhone, AirPods, and Apple Watch", icon: "🔌" },
            { id: 63, name: "Twelve South BookArc", category: "accessories", price: 49, originalPrice: 69, rating: 4.4, badge: "MacBook", description: "Vertical laptop stand", icon: "💻" },
            { id: 64, name: "Anker USB-C Hub", category: "accessories", price: 39, originalPrice: 59, rating: 4.3, badge: "Multiport", description: "7-in-1 USB-C hub", icon: "🔌" },
            { id: 65, name: "Peak Design Mobile Tripod", category: "accessories", price: 79, originalPrice: 99, rating: 4.6, badge: "Photography", description: "Compact phone tripod", icon: "📷" },
            { id: 66, name: "Lamicall Phone Stand", category: "accessories", price: 12, originalPrice: 19, rating: 4.2, badge: "Desk", description: "Adjustable phone holder", icon: "📱" },
            { id: 67, name: "Anker PowerWave Stand", category: "accessories", price: 25, originalPrice: 35, rating: 4.1, badge: "Qi Wireless", description: "10W wireless charging stand", icon: "🔌" },
            { id: 68, name: "Spigen Tough Armor Case", category: "accessories", price: 15, originalPrice: 25, rating: 4.4, badge: "Protection", description: "Dual-layer phone protection", icon: "📱" },
            { id: 69, name: "UGREEN 65W GaN Charger", category: "accessories", price: 35, originalPrice: 49, rating: 4.5, badge: "Fast", description: "Compact USB-C PD charger", icon: "🔌" },
            { id: 70, name: "Logitech C920s Webcam", category: "accessories", price: 69, originalPrice: 99, rating: 4.3, badge: "HD", description: "1080p webcam with privacy shutter", icon: "📹" },
            { id: 71, name: "Blue Yeti Nano", category: "accessories", price: 79, originalPrice: 99, rating: 4.4, badge: "USB Mic", description: "Professional USB microphone", icon: "🎤" },
            { id: 72, name: "Elgato Key Light Mini", category: "accessories", price: 79, originalPrice: 99, rating: 4.2, badge: "Streaming", description: "Compact LED panel for video calls", icon: "💡" },
            { id: 73, name: "HyperX Alloy Origins 60", category: "accessories", price: 89, originalPrice: 119, rating: 4.3, badge: "60%", description: "Compact mechanical gaming keyboard", icon: "⌨️" },
            { id: 74, name: "Steelseries QcK Gaming Pad", category: "accessories", price: 12, originalPrice: 19, rating: 4.1, badge: "Gaming", description: "High-performance gaming mouse pad", icon: "🖱️" },
            { id: 75, name: "Cable Matters USB-C to HDMI", category: "accessories", price: 16, originalPrice: 24, rating: 4.2, badge: "4K", description: "4K@60Hz display adapter", icon: "🔌" },

            // Gaming (10 products)
            { id: 76, name: "Xbox Wireless Controller", category: "gaming", price: 49, originalPrice: 59, rating: 4.6, badge: "Xbox", description: "Compatible with Xbox, PC, and mobile", icon: "🎮" },
            { id: 77, name: "8BitDo SN30 Pro+", category: "gaming", price: 39, originalPrice: 49, rating: 4.4, badge: "Retro", description: "Bluetooth controller for multiple platforms", icon: "🎮" },
            { id: 78, name: "Razer Kishi V2", category: "gaming", price: 79, originalPrice: 99, rating: 4.3, badge: "Mobile", description: "Universal mobile gaming controller", icon: "🎮" },
            { id: 79, name: "SteelSeries Arctis 7P", category: "gaming", price: 129, originalPrice: 149, rating: 4.5, badge: "Wireless", description: "Lossless 2.4GHz gaming headset", icon: "🎧" },
            { id: 80, name: "HyperX Cloud II", category: "gaming", price: 69, originalPrice: 99, rating: 4.4, badge: "7.1 Surround", description: "Virtual 7.1 surround sound", icon: "🎧" },
            { id: 81, name: "Corsair K55 RGB", category: "gaming", price: 39, originalPrice: 59, rating: 4.1, badge: "RGB", description: "Membrane gaming keyboard with RGB", icon: "⌨️" },
            { id: 82, name: "Logitech G502 HERO", category: "gaming", price: 49, originalPrice: 79, rating: 4.6, badge: "Precision", description: "High-precision gaming mouse", icon: "🖱️" },
            { id: 83, name: "ASUS TUF Gaming VG24VQ", category: "gaming", price: 139, originalPrice: 179, rating: 4.2, badge: "144Hz", description: "24-inch curved gaming monitor", icon: "🖥️" },
            { id: 84, name: "Elgato Stream Deck Mini", category: "gaming", price: 69, originalPrice: 99, rating: 4.3, badge: "Streaming", description: "6-key customizable control pad", icon: "🎛️" },
            { id: 85, name: "PowerA Enhanced Wireless", category: "gaming", price: 29, originalPrice: 49, rating: 4.0, badge: "Budget", description: "Wireless controller for Nintendo Switch", icon: "🎮" },

            // Smart Home (8 products)
            { id: 86, name: "Amazon Echo Dot (5th Gen)", category: "smart-home", price: 39, originalPrice: 49, rating: 4.4, badge: "Alexa", description: "Smart speaker with improved audio", icon: "🔊" },
            { id: 87, name: "Google Nest Mini", category: "smart-home", price: 29, originalPrice: 49, rating: 4.2, badge: "Google", description: "Compact smart speaker", icon: "🔊" },
            { id: 88, name: "TP-Link Kasa Smart Plug", category: "smart-home", price: 9, originalPrice: 14, rating: 4.3, badge: "WiFi", description: "WiFi smart plug with app control", icon: "🔌" },
            { id: 89, name: "Philips Hue White A19", category: "smart-home", price: 12, originalPrice: 19, rating: 4.1, badge: "Smart Light", description: "Dimmable LED smart bulb", icon: "💡" },
            { id: 90, name: "Ring Video Doorbell", category: "smart-home", price: 99, originalPrice: 149, rating: 4.0, badge: "Security", description: "1080p HD video doorbell", icon: "🔔" },
            { id: 91, name: "Wyze Cam v3", category: "smart-home", price: 25, originalPrice: 35, rating: 4.2, badge: "Security", description: "1080p wireless security camera", icon: "📹" },
            { id: 92, name: "Sengled Smart LED Strip", category: "smart-home", price: 19, originalPrice: 29, rating: 4.0, badge: "RGB", description: "16ft WiFi LED strip lights", icon: "💡" },
            { id: 93, name: "Govee Thermometer Hygrometer", category: "smart-home", price: 8, originalPrice: 12, rating: 4.1, badge: "Monitor", description: "WiFi temperature and humidity sensor", icon: "🌡️" },

            // Wearables (7 products)
            { id: 94, name: "Amazfit GTS 4 Mini", category: "wearables", price: 79, originalPrice: 99, rating: 4.2, badge: "Fitness", description: "120+ sports modes with GPS", icon: "⌚" },
            { id: 95, name: "Xiaomi Mi Band 7", category: "wearables", price: 39, originalPrice: 49, rating: 4.3, badge: "Budget", description: "1.62-inch AMOLED display", icon: "⌚" },
            { id: 96, name: "Fitbit Charge 5", category: "wearables", price: 149, originalPrice: 199, rating: 4.4, badge: "Health", description: "Advanced health and fitness tracker", icon: "⌚" },
            { id: 97, name: "Samsung Galaxy Watch4", category: "wearables", price: 179, originalPrice: 249, rating: 4.1, badge: "Wear OS", description: "Wear OS with body composition analysis", icon: "⌚" },
            { id: 98, name: "Garmin Venu Sq 2", category: "wearables", price: 199, originalPrice: 249, rating: 4.5, badge: "GPS", description: "Built-in GPS with 11-day battery", icon: "⌚" },
            { id: 99, name: "HUAWEI Watch GT 3", category: "wearables", price: 159, originalPrice: 199, rating: 4.2, badge: "Style", description: "Classic design with 14-day battery", icon: "⌚" },
            { id: 100, name: "Apple Watch SE (2nd Gen)", category: "wearables", price: 229, originalPrice: 279, rating: 4.6, badge: "Apple", description: "S8 chip with Crash Detection", icon: "⌚" }
        ];

        // Global variables
        let cart = [];
        let currentPage = 1;
        const productsPerPage = 12;
        let filteredProducts = [...products];
        let currentUser = null;
        let registeredUsers = []; // Store registered users
        let pendingVerifications = []; // Store pending email verifications

        // Email validation functions
        function isValidEmail(email) {
            // Comprehensive email validation regex
            const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
            return emailRegex.test(email);
        }

        function isValidEmailDomain(email) {
            // List of common valid email domains
            const validDomains = [
                'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'live.com',
                'aol.com', 'icloud.com', 'mail.com', 'protonmail.com', 'zoho.com',
                'yandex.com', 'fastmail.com', 'tutanota.com', 'gmx.com', 'mail.ru',
                'qq.com', '163.com', 'sina.com', 'sohu.com', 'yeah.net',
                // Educational domains
                'edu', 'ac.uk', 'edu.au', 'edu.in', 'edu.pk', 'edu.sg',
                // Business domains (common ones)
                'company.com', 'business.com', 'work.com', 'office.com',
                // Country specific
                'co.uk', 'co.in', 'co.jp', 'co.kr', 'co.za', 'com.au',
                'com.br', 'com.mx', 'com.tr', 'com.pk', 'com.sg'
            ];
            
            const domain = email.split('@')[1]?.toLowerCase();
            if (!domain) return false;
            
            // Check if it's a valid domain format
            if (domain.includes('..') || domain.startsWith('.') || domain.endsWith('.')) {
                return false;
            }
            
            // Check against common valid domains
            return validDomains.some(validDomain => {
                return domain === validDomain || domain.endsWith('.' + validDomain);
            });
        }

        async function validateEmailExists(email) {
            // Simulate email existence check with some basic validation
            const domain = email.split('@')[1];
            
            // Basic domain validation
            if (!domain || domain.length < 3 || !domain.includes('.')) {
                return false;
            }
            
            // Simulate async validation (in real app, this would be an API call)
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simulate validation logic
                    const isValid = isValidEmailDomain(email) && 
                                  !email.includes('fake') && 
                                  !email.includes('invalid') &&
                                  !email.includes('test123') &&
                                  !email.includes('dummy');
                    resolve(isValid);
                }, 1000);
            });
        }

        function validatePassword(password) {
            const minLength = 8;
            const hasUpperCase = /[A-Z]/.test(password);
            const hasLowerCase = /[a-z]/.test(password);
            const hasNumbers = /\d/.test(password);
            const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
            
            const requirements = [];
            if (password.length < minLength) requirements.push('at least 8 characters');
            if (!hasUpperCase) requirements.push('one uppercase letter');
            if (!hasLowerCase) requirements.push('one lowercase letter');
            if (!hasNumbers) requirements.push('one number');
            if (!hasSpecialChar) requirements.push('one special character');
            
            return {
                isValid: requirements.length === 0,
                requirements: requirements
            };
        }

        function isEmailRegistered(email) {
            return registeredUsers.some(user => user.email.toLowerCase() === email.toLowerCase());
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            updateCartUI();
            setupEventListeners();
            initializeDemoUsers();
        });

        function initializeDemoUsers() {
            // Add some demo users for testing
            registeredUsers = [
                {
                    id: 1,
                    name: 'John Doe',
                    email: 'john@gmail.com',
                    password: 'Password123!',
                    registeredAt: new Date('2024-01-15').toISOString()
                },
                {
                    id: 2,
                    name: 'Jane Smith',
                    email: 'jane@yahoo.com',
                    password: 'SecurePass456@',
                    registeredAt: new Date('2024-02-20').toISOString()
                },
                {
                    id: 3,
                    name: 'Mike Johnson',
                    email: 'mike@outlook.com',
                    password: 'MyPass789#',
                    registeredAt: new Date('2024-03-10').toISOString()
                }
            ];
            
            // For debugging - you can remove this later
            console.log('Demo users initialized:', registeredUsers.length, 'users');
        }

        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // Filter change listeners
            document.getElementById('categoryFilter').addEventListener('change', applyFilters);
            document.getElementById('priceFilter').addEventListener('change', applyFilters);
            document.getElementById('sortFilter').addEventListener('change', applyFilters);

            // Auth form listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);

            // Real-time validation for register form
            const registerForm = document.getElementById('registerForm');
            const emailInput = registerForm.querySelector('input[name="email"]');
            const passwordInput = registerForm.querySelector('input[name="password"]');
            const confirmPasswordInput = registerForm.querySelector('input[name="confirmPassword"]');

            emailInput.addEventListener('input', handleEmailValidation);
            passwordInput.addEventListener('input', handlePasswordValidation);
            confirmPasswordInput.addEventListener('input', handleConfirmPasswordValidation);

            // Close modal when clicking outside the modal content (not inside)
            document.getElementById('authModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAuthModal();
                }
            });

            // Prevent modal from closing when clicking inside the modal content
            document.querySelector('.auth-modal').addEventListener('click', function(e) {
                e.stopPropagation();
            });

            // Settings modal click outside to close
            document.getElementById('settingsModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSettingsModal();
                }
            });

            // Prevent settings modal from closing when clicking inside
            document.querySelector('.settings-modal').addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }

        let emailValidationTimeout;
        async function handleEmailValidation(e) {
            const email = e.target.value;
            const statusDiv = document.getElementById('emailValidationStatus');
            const errorDiv = document.getElementById('registerEmailError');
            
            // Clear previous timeout
            if (emailValidationTimeout) {
                clearTimeout(emailValidationTimeout);
            }
            
            // Reset states
            errorDiv.textContent = '';
            e.target.classList.remove('error', 'success', 'checking');
            
            if (!email) {
                statusDiv.textContent = '';
                statusDiv.className = 'validation-status';
                return;
            }
            
            // Basic format validation
            if (!isValidEmail(email)) {
                errorDiv.textContent = 'Please enter a valid email address';
                e.target.classList.add('error');
                statusDiv.textContent = '';
                return;
            }
            
            // Check if already registered
            if (isEmailRegistered(email)) {
                errorDiv.textContent = 'This email is already registered. Please use a different email or login.';
                e.target.classList.add('error');
                statusDiv.textContent = '';
                return;
            }
            
            // Show checking status
            statusDiv.textContent = 'Validating email...';
            statusDiv.className = 'validation-status checking';
            e.target.classList.add('checking');
            
            // Debounce validation
            emailValidationTimeout = setTimeout(async () => {
                try {
                    const isValid = await validateEmailExists(email);
                    
                    if (isValid) {
                        statusDiv.textContent = '✓ Email is valid';
                        statusDiv.className = 'validation-status valid';
                        e.target.classList.remove('checking');
                        e.target.classList.add('success');
                    } else {
                        errorDiv.textContent = 'Please enter a valid email address from a recognized domain';
                        statusDiv.textContent = '';
                        statusDiv.className = 'validation-status';
                        e.target.classList.remove('checking');
                        e.target.classList.add('error');
                    }
                } catch (error) {
                    errorDiv.textContent = 'Unable to validate email. Please try again.';
                    statusDiv.textContent = '';
                    statusDiv.className = 'validation-status';
                    e.target.classList.remove('checking');
                    e.target.classList.add('error');
                }
            }, 1000);
        }

        function handlePasswordValidation(e) {
            const password = e.target.value;
            const validation = validatePassword(password);
            const errorDiv = document.getElementById('registerPasswordError');
            
            // Update requirements display
            const requirements = {
                'req-length': password.length >= 8,
                'req-upper': /[A-Z]/.test(password),
                'req-lower': /[a-z]/.test(password),
                'req-number': /\d/.test(password),
                'req-special': /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };
            
            Object.entries(requirements).forEach(([id, isValid]) => {
                const element = document.getElementById(id);
                if (isValid) {
                    element.textContent = element.textContent.replace('✗', '✓');
                    element.classList.add('valid');
                    element.classList.remove('invalid');
                } else {
                    element.textContent = element.textContent.replace('✓', '✗');
                    element.classList.add('invalid');
                    element.classList.remove('valid');
                }
            });
            
            // Update input styling
            if (password && validation.isValid) {
                e.target.classList.remove('error');
                e.target.classList.add('success');
                errorDiv.textContent = '';
            } else if (password) {
                e.target.classList.remove('success');
                e.target.classList.add('error');
            } else {
                e.target.classList.remove('error', 'success');
            }
        }

        function handleConfirmPasswordValidation(e) {
            const passwordInput = document.querySelector('#registerForm input[name="password"]');
            const password = passwordInput.value;
            const confirmPassword = e.target.value;
            const errorDiv = document.getElementById('registerConfirmPasswordError');
            
            if (!confirmPassword) {
                errorDiv.textContent = '';
                e.target.classList.remove('error', 'success');
                return;
            }
            
            if (password !== confirmPassword) {
                errorDiv.textContent = 'Passwords do not match';
                e.target.classList.add('error');
                e.target.classList.remove('success');
            } else {
                errorDiv.textContent = '';
                e.target.classList.remove('error');
                e.target.classList.add('success');
            }
        }

        // Email verification functions
        function generateVerificationCode() {
            return Math.floor(100000 + Math.random() * 900000).toString(); // 6-digit code
        }

        async function sendVerificationEmail(email, code) {
            // Simulate sending email
            console.log(`Verification code for ${email}: ${code}`);
            
            // In a real application, this would send an actual email
            // For demo purposes, we'll show the code prominently
            showNotification(`📧 EMAIL VERIFICATION CODE: ${code}`, 'info', 15000); // Show for 15 seconds
            
            return new Promise(resolve => setTimeout(resolve, 1000));
        }

        function createVerificationStep(email, userData) {
            const verificationCode = generateVerificationCode();
            
            // Store pending verification
            pendingVerifications.push({
                email: email,
                code: verificationCode,
                userData: userData,
                timestamp: Date.now(),
                attempts: 0
            });

            // Send verification email
            sendVerificationEmail(email, verificationCode);

            // Create verification form
            showVerificationModal(email);
        }

        function showVerificationModal(email) {
            const modal = document.getElementById('authModal');
            const modalContent = modal.querySelector('.auth-modal');
            
            modalContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <i class="fas fa-envelope" style="font-size: 3rem; color: #3b82f6; margin-bottom: 1rem;"></i>
                    <h2 style="color: #1e293b; margin-bottom: 0.5rem;">Verify Your Email</h2>
                    <p style="color: #64748b; font-size: 0.9rem; margin-bottom: 1rem;">
                        We've sent a 6-digit verification code to:<br>
                        <strong>${email}</strong>
                    </p>
                    <div style="background: rgba(59, 130, 246, 0.1); padding: 0.75rem; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3); margin-bottom: 1rem;">
                        <p style="color: #3b82f6; font-size: 0.85rem; margin: 0;">
                            <strong>📧 DEMO MODE:</strong> Check the blue notification above for your verification code!
                        </p>
                    </div>
                </div>
                
                <form id="verificationForm">
                    <div class="form-group">
                        <label>Verification Code:</label>
                        <input type="text" name="verificationCode" placeholder="Enter 6-digit code" maxlength="6" required 
                               style="text-align: center; font-size: 1.2rem; letter-spacing: 0.2rem; font-weight: bold;">
                        <div class="error-message" id="verificationError"></div>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%; margin-bottom: 1rem;">
                        <span class="btn-text">Verify Email</span>
                        <div class="btn-spinner hidden">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                    </button>
                    
                    <div style="text-align: center;">
                        <button type="button" onclick="resendVerificationCode('${email}')" 
                                style="background: none; border: none; color: #3b82f6; cursor: pointer; font-size: 0.9rem; text-decoration: underline;">
                            Resend Code
                        </button>
                        <span style="margin: 0 1rem; color: #64748b;">|</span>
                        <button type="button" onclick="closeAuthModal()" 
                                style="background: none; border: none; color: #64748b; cursor: pointer; font-size: 0.9rem;">
                            Cancel
                        </button>
                    </div>
                </form>
            `;

            // Add event listener for verification form
            document.getElementById('verificationForm').addEventListener('submit', handleEmailVerification);
            
            // Auto-focus on input
            setTimeout(() => {
                const input = modalContent.querySelector('input[name="verificationCode"]');
                input.focus();
                
                // Format input as user types
                input.addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/\D/g, ''); // Only numbers
                });
            }, 100);
        }

        async function handleEmailVerification(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const enteredCode = formData.get('verificationCode').trim();
            const email = pendingVerifications[pendingVerifications.length - 1]?.email;
            
            const errorDiv = document.getElementById('verificationError');
            errorDiv.textContent = '';
            
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                if (!enteredCode || enteredCode.length !== 6) {
                    throw new Error('Please enter a valid 6-digit code');
                }
                
                // Find pending verification
                const verification = pendingVerifications.find(v => v.email === email);
                if (!verification) {
                    throw new Error('Verification session expired. Please try again.');
                }
                
                // Check attempts
                verification.attempts++;
                if (verification.attempts > 3) {
                    // Remove from pending
                    pendingVerifications = pendingVerifications.filter(v => v.email !== email);
                    throw new Error('Too many failed attempts. Please start over.');
                }
                
                // Check if code expired (10 minutes)
                if (Date.now() - verification.timestamp > 10 * 60 * 1000) {
                    pendingVerifications = pendingVerifications.filter(v => v.email !== email);
                    throw new Error('Verification code expired. Please try again.');
                }
                
                // Verify code
                if (enteredCode !== verification.code) {
                    throw new Error(`Invalid code. ${3 - verification.attempts} attempts remaining.`);
                }
                
                // Code is correct - complete registration
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const newUser = {
                    id: Date.now(),
                    name: verification.userData.name,
                    email: verification.userData.email.toLowerCase(),
                    password: verification.userData.password,
                    registeredAt: new Date().toISOString(),
                    emailVerified: true
                };
                
                registeredUsers.push(newUser);
                
                // Auto-login
                currentUser = {
                    id: newUser.id,
                    name: newUser.name,
                    email: newUser.email,
                    password: newUser.password,
                    registeredAt: newUser.registeredAt
                };
                
                showNotification(`Welcome to TechMart, ${newUser.name}! Your account has been verified and created successfully.`, 'success');
                updateUserInterface();
                
                // Remove from pending verifications
                pendingVerifications = pendingVerifications.filter(v => v.email !== email);
                
                closeAuthModal();
                
            } catch (error) {
                errorDiv.textContent = error.message;
                form.querySelector('input[name="verificationCode"]').classList.add('error');
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        async function resendVerificationCode(email) {
            const verification = pendingVerifications.find(v => v.email === email);
            if (!verification) {
                showNotification('Verification session not found. Please start over.', 'error');
                closeAuthModal();
                return;
            }
            
            // Generate new code
            const newCode = generateVerificationCode();
            verification.code = newCode;
            verification.timestamp = Date.now();
            verification.attempts = 0;
            
            // Send new code
            showNotification(`🔄 NEW VERIFICATION CODE: ${newCode}`, 'info', 15000);
            showNotification('New verification code sent!', 'success');
        }

        function loadProducts() {
            const productsGrid = document.getElementById('productsGrid');
            productsGrid.innerHTML = '';

            const startIndex = (currentPage - 1) * productsPerPage;
            const endIndex = startIndex + productsPerPage;
            const pageProducts = filteredProducts.slice(startIndex, endIndex);

            pageProducts.forEach(product => {
                const productCard = createProductCard(product);
                productsGrid.appendChild(productCard);
            });

            updatePagination();
        }

        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <div class="product-image">
                    <span style="font-size: 3rem;">${product.icon}</span>
                    <div class="product-badge">${product.badge}</div>
                </div>
                <div class="product-title">${product.name}</div>
                <div class="product-description">${product.description}</div>
                <div class="product-rating">
                    <div class="stars">${generateStars(product.rating)}</div>
                    <span>(${product.rating})</span>
                </div>
                <div class="product-price">
                    <span class="price-current">${product.price}</span>
                    <span class="price-original">${product.originalPrice}</span>
                </div>
                <div class="product-actions">
                    <button class="btn btn-small" onclick="addToCart(${product.id})">
                        <i class="fas fa-shopping-cart"></i> Add to Cart
                    </button>
                    <button class="btn btn-secondary btn-small" onclick="viewProduct(${product.id})">
                        <i class="fas fa-eye"></i> View
                    </button>
                </div>
            `;
            return card;
        }

        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let stars = '';
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }
            return stars;
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...product, quantity: 1});
            }
            
            updateCartUI();
            showNotification(`${product.name} added to cart!`);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
        }

        function updateQuantity(productId, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }
            
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity = newQuantity;
                updateCartUI();
            }
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const subtotal = document.getElementById('subtotal');
            const tax = document.getElementById('tax');
            const total = document.getElementById('total');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            cartItems.innerHTML = '';
            let subtotalAmount = 0;
            
            cart.forEach(item => {
                subtotalAmount += item.price * item.quantity;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-image">
                        <span>${item.icon}</span>
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-price">${item.price}</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, ${item.quantity - 1})">-</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, ${item.quantity + 1})">+</button>
                            <button class="quantity-btn" onclick="removeFromCart(${item.id})" style="margin-left: 0.5rem; background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: #ef4444;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });
            
            const taxAmount = subtotalAmount * 0.08; // 8% tax
            const totalAmount = subtotalAmount + taxAmount;
            
            subtotal.textContent = `${subtotalAmount.toFixed(2)}`;
            tax.textContent = `${taxAmount.toFixed(2)}`;
            total.textContent = `${totalAmount.toFixed(2)}`;
        }

        function toggleCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            cartSidebar.classList.toggle('open');
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            filteredProducts = products.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm)
            );
            currentPage = 1;
            loadProducts();
        }

        function filterByCategory(category) {
            if (category === 'all') {
                filteredProducts = [...products];
            } else {
                filteredProducts = products.filter(product => product.category === category);
            }
            currentPage = 1;
            loadProducts();
        }

        function applyFilters() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const priceFilter = document.getElementById('priceFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;
            
            // Start with all products
            filteredProducts = [...products];
            
            // Apply category filter
            if (categoryFilter !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === categoryFilter);
            }
            
            // Apply price filter
            if (priceFilter !== 'all') {
                const [min, max] = priceFilter.split('-').map(p => p === '+' ? Infinity : parseInt(p));
                filteredProducts = filteredProducts.filter(product => {
                    if (max === undefined) return product.price >= min;
                    return product.price >= min && product.price <= max;
                });
            }
            
            // Apply sorting
            switch (sortFilter) {
                case 'price-low':
                    filteredProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filteredProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'rating':
                    filteredProducts.sort((a, b) => b.rating - a.rating);
                    break;
                case 'newest':
                    filteredProducts.sort((a, b) => b.id - a.id);
                    break;
                default:
                    // Featured - keep original order
                    break;
            }
            
            currentPage = 1;
            loadProducts();
        }

        function resetFilters() {
            document.getElementById('categoryFilter').value = 'all';
            document.getElementById('priceFilter').value = 'all';
            document.getElementById('sortFilter').value = 'featured';
            document.getElementById('searchInput').value = '';
            filteredProducts = [...products];
            currentPage = 1;
            loadProducts();
        }

        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
            
            pagination.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Previous button
            if (currentPage > 1) {
                const prevBtn = document.createElement('button');
                prevBtn.className = 'page-btn';
                prevBtn.textContent = '←';
                prevBtn.onclick = () => changePage(currentPage - 1);
                pagination.appendChild(prevBtn);
            }
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = 'page-btn';
                    if (i === currentPage) pageBtn.classList.add('active');
                    pageBtn.textContent = i;
                    pageBtn.onclick = () => changePage(i);
                    pagination.appendChild(pageBtn);
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0.5rem';
                    pagination.appendChild(ellipsis);
                }
            }
            
            // Next button
            if (currentPage < totalPages) {
                const nextBtn = document.createElement('button');
                nextBtn.className = 'page-btn';
                nextBtn.textContent = '→';
                nextBtn.onclick = () => changePage(currentPage + 1);
                pagination.appendChild(nextBtn);
            }
        }

        function changePage(page) {
            currentPage = page;
            loadProducts();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function scrollToProducts() {
            const productsSection = document.getElementById('products-section');
            const headerHeight = document.querySelector('.header').offsetHeight;
            const elementPosition = productsSection.offsetTop;
            const offsetPosition = elementPosition - headerHeight - 10; // 10px extra padding
            
            window.scrollTo({
                top: Math.max(0, offsetPosition),
                behavior: 'smooth'
            });
        }

        // Auth functions
        function openAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            
            // Reset modal content to default login/register forms after a short delay
            setTimeout(() => {
                const modalContent = document.querySelector('.auth-modal');
                modalContent.innerHTML = `
                    <div class="auth-tabs">
                        <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                        <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
                    </div>
                    
                    <form id="loginForm">
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" name="email" placeholder="Enter your email" required>
                            <div class="error-message" id="loginEmailError"></div>
                        </div>
                        <div class="form-group">
                            <label>Password:</label>
                            <input type="password" name="password" placeholder="Enter your password" required>
                            <div class="error-message" id="loginPasswordError"></div>
                        </div>
                        <div class="error-message" id="loginError"></div>
                        <button type="submit" class="btn" style="width: 100%;">
                            <span class="btn-text">Login</span>
                            <div class="btn-spinner hidden">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>

                    <form id="registerForm" class="hidden">
                        <div class="form-group">
                            <label>Full Name:</label>
                            <input type="text" name="fullName" placeholder="Enter your full name" required>
                            <div class="error-message" id="registerNameError"></div>
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" name="email" placeholder="Enter your email" required>
                            <div class="error-message" id="registerEmailError"></div>
                            <div class="validation-status" id="emailValidationStatus"></div>
                        </div>
                        <div class="form-group">
                            <label>Password:</label>
                            <input type="password" name="password" placeholder="Create a password" required>
                            <div class="error-message" id="registerPasswordError"></div>
                            <div class="password-requirements" id="passwordRequirements">
                                <div class="requirement" id="req-length">✗ At least 8 characters</div>
                                <div class="requirement" id="req-upper">✗ One uppercase letter</div>
                                <div class="requirement" id="req-lower">✗ One lowercase letter</div>
                                <div class="requirement" id="req-number">✗ One number</div>
                                <div class="requirement" id="req-special">✗ One special character</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Confirm Password:</label>
                            <input type="password" name="confirmPassword" placeholder="Confirm your password" required>
                            <div class="error-message" id="registerConfirmPasswordError"></div>
                        </div>
                        <div class="error-message" id="registerError"></div>
                        <button type="submit" class="btn" style="width: 100%;">
                            <span class="btn-text">Register</span>
                            <div class="btn-spinner hidden">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>

                    <button onclick="closeAuthModal()" style="background: none; border: none; color: #64748b; margin-top: 1rem; cursor: pointer; font-size: 0.9rem; transition: color 0.3s ease;">
                        Close
                    </button>
                `;
                
                // Re-add event listeners
                document.getElementById('loginForm').addEventListener('submit', handleLogin);
                document.getElementById('registerForm').addEventListener('submit', handleRegister);

                // Re-add real-time validation listeners
                const registerForm = document.getElementById('registerForm');
                const emailInput = registerForm.querySelector('input[name="email"]');
                const passwordInput = registerForm.querySelector('input[name="password"]');
                const confirmPasswordInput = registerForm.querySelector('input[name="confirmPassword"]');

                emailInput.addEventListener('input', handleEmailValidation);
                passwordInput.addEventListener('input', handlePasswordValidation);
                confirmPasswordInput.addEventListener('input', handleConfirmPasswordValidation);
            }, 300);
        }

        function switchAuthTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const tabs = document.querySelectorAll('.auth-tab');
            
            tabs.forEach(t => t.classList.remove('active'));
            
            if (tab === 'login') {
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
                tabs[0].classList.add('active');
            } else {
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
                tabs[1].classList.add('active');
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const email = formData.get('email').trim();
            const password = formData.get('password');
            
            // Clear previous errors
            clearFormErrors('login');
            
            // Show loading state
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                // Basic validation
                if (!email || !password) {
                    throw new Error('Please fill in all fields');
                }
                
                if (!isValidEmail(email)) {
                    throw new Error('Please enter a valid email address');
                }
                
                // Check if user is registered
                const user = registeredUsers.find(u => u.email.toLowerCase() === email.toLowerCase());
                if (!user) {
                    throw new Error('No account found with this email address. Please register first.');
                }
                
                // Simulate login validation
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Check password
                if (user.password !== password) {
                    throw new Error('Invalid password. Please try again.');
                }
                
                // Successful login
                currentUser = {
                    id: user.id,
                    name: user.name,
                    email: user.email,
                    password: user.password,
                    registeredAt: user.registeredAt
                };
                
                showNotification(`Welcome back, ${user.name}!`);
                closeAuthModal();
                updateUserInterface();
                
            } catch (error) {
                document.getElementById('loginError').textContent = error.message;
                form.querySelector('input[name="email"]').classList.add('error');
                form.querySelector('input[name="password"]').classList.add('error');
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const fullName = formData.get('fullName').trim();
            const email = formData.get('email').trim();
            const password = formData.get('password');
            const confirmPassword = formData.get('confirmPassword');
            
            // Clear previous errors
            clearFormErrors('register');
            
            // Show loading state
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                // Basic validation
                if (!fullName || !email || !password || !confirmPassword) {
                    throw new Error('Please fill in all fields');
                }
                
                if (fullName.length < 2) {
                    document.getElementById('registerNameError').textContent = 'Name must be at least 2 characters long';
                    form.querySelector('input[name="fullName"]').classList.add('error');
                    throw new Error('Please enter a valid name');
                }
                
                if (!isValidEmail(email)) {
                    document.getElementById('registerEmailError').textContent = 'Please enter a valid email address';
                    form.querySelector('input[name="email"]').classList.add('error');
                    throw new Error('Invalid email format');
                }
                
                if (isEmailRegistered(email)) {
                    document.getElementById('registerEmailError').textContent = 'This email is already registered';
                    form.querySelector('input[name="email"]').classList.add('error');
                    throw new Error('Email already registered');
                }
                
                // Validate email exists
                const emailExists = await validateEmailExists(email);
                if (!emailExists) {
                    document.getElementById('registerEmailError').textContent = 'Please enter a valid email address from a recognized domain';
                    form.querySelector('input[name="email"]').classList.add('error');
                    throw new Error('Invalid email domain');
                }
                
                // Password validation
                const passwordValidation = validatePassword(password);
                if (!passwordValidation.isValid) {
                    document.getElementById('registerPasswordError').textContent = 'Password must meet all requirements';
                    form.querySelector('input[name="password"]').classList.add('error');
                    throw new Error('Password does not meet requirements');
                }
                
                if (password !== confirmPassword) {
                    document.getElementById('registerConfirmPasswordError').textContent = 'Passwords do not match';
                    form.querySelector('input[name="confirmPassword"]').classList.add('error');
                    throw new Error('Passwords do not match');
                }
                
                // All validation passed - proceed with email verification
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const userData = {
                    name: fullName,
                    email: email,
                    password: password
                };
                
                // Start email verification process
                createVerificationStep(email, userData);
                
            } catch (error) {
                if (error.message === 'Please fill in all fields' || 
                    error.message === 'Please enter a valid name' ||
                    error.message === 'Invalid email format' ||
                    error.message === 'Email already registered' ||
                    error.message === 'Invalid email domain' ||
                    error.message === 'Password does not meet requirements' ||
                    error.message === 'Passwords do not match') {
                    // Specific field errors are already handled above
                } else {
                    document.getElementById('registerError').textContent = error.message;
                }
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        function clearFormErrors(formType) {
            const form = document.getElementById(`${formType}Form`);
            if (!form) return;
            
            const errorElements = form.querySelectorAll('.error-message');
            errorElements.forEach(el => el.textContent = '');
            
            const inputs = form.querySelectorAll('input');
            inputs.forEach(input => input.classList.remove('error', 'success', 'checking'));
        }

        function setButtonLoading(button, isLoading) {
            const textSpan = button.querySelector('.btn-text');
            const spinner = button.querySelector('.btn-spinner');
            
            if (isLoading) {
                textSpan.classList.add('hidden');
                spinner.classList.remove('hidden');
                spinner.classList.add('active');
                button.disabled = true;
            } else {
                textSpan.classList.remove('hidden');
                spinner.classList.add('hidden');
                spinner.classList.remove('active');
                button.disabled = false;
            }
        }

        function updateUserInterface() {
            // Update user icon to show logged-in state
            const userIcon = document.querySelector('.user-icon');
            const userDropdown = document.getElementById('userDropdown');
            
            if (currentUser) {
                userIcon.style.background = 'rgba(16, 185, 129, 0.2)';
                userIcon.style.color = '#10b981';
                userIcon.title = `Logged in as ${currentUser.name}`;
                
                // Update dropdown content
                userDropdown.innerHTML = `
                    <div class="user-dropdown-header">
                        <div class="user-name">${currentUser.name}</div>
                        <div class="user-email">${currentUser.email}</div>
                    </div>
                    <div class="user-dropdown-menu">
                        <div class="dropdown-item" onclick="openSettingsModal()">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </div>
                        <div class="dropdown-item" onclick="logoutUser()">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </div>
                    </div>
                `;
            } else {
                userIcon.style.background = 'rgba(59, 130, 246, 0.1)';
                userIcon.style.color = '#3b82f6';
                userIcon.title = '';
                
                // Update dropdown content
                userDropdown.innerHTML = `
                    <div class="user-dropdown-header">
                        <div class="user-name">Guest User</div>
                        <div class="user-email">Please login</div>
                    </div>
                    <div class="user-dropdown-menu">
                        <div class="dropdown-item" onclick="openAuthModal()">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Login / Register</span>
                        </div>
                    </div>
                `;
            }
        }

        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            const isActive = dropdown.classList.contains('active');
            
            // Close other dropdowns first
            document.querySelectorAll('.user-dropdown').forEach(d => d.classList.remove('active'));
            
            if (!isActive) {
                dropdown.classList.add('active');
                
                // Close dropdown when clicking outside
                setTimeout(() => {
                    document.addEventListener('click', closeUserDropdownOutside);
                }, 0);
            }
        }

        function closeUserDropdownOutside(e) {
            const dropdown = document.getElementById('userDropdown');
            const userIcon = document.querySelector('.user-icon');
            
            if (!dropdown.contains(e.target) && !userIcon.contains(e.target)) {
                dropdown.classList.remove('active');
                document.removeEventListener('click', closeUserDropdownOutside);
            }
        }

        function logoutUser() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                updateUserInterface();
                closeUserDropdown();
                showNotification('You have been logged out successfully.', 'success');
            }
        }

        function closeUserDropdown() {
            document.getElementById('userDropdown').classList.remove('active');
            document.removeEventListener('click', closeUserDropdownOutside);
        }

        // Settings Modal Functions
        function openSettingsModal() {
            closeUserDropdown();
            document.getElementById('settingsModal').classList.add('active');
            
            // Always start with Account tab
            switchSettingsTab('account');
            
            // Update current email display
            if (currentUser) {
                document.getElementById('currentEmailDisplay').textContent = currentUser.email;
            }
            
            clearAllSettingsForms();
            setupSettingsEventListeners();
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.remove('active');
            clearAllSettingsForms();
        }

        function switchSettingsTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
            
            // Find and activate the correct tab button
            const tabButtons = document.querySelectorAll('.settings-tab');
            tabButtons.forEach(button => {
                if ((tab === 'account' && button.textContent === 'Account') ||
                    (tab === 'security' && button.textContent === 'Security') ||
                    (tab === 'danger' && button.textContent === 'Delete Account')) {
                    button.classList.add('active');
                }
            });
            
            // Update content
            document.querySelectorAll('.settings-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tab + 'Settings').classList.add('active');
        }

        function clearAllSettingsForms() {
            // Clear email change form
            const emailForm = document.getElementById('changeEmailForm');
            if (emailForm) {
                emailForm.reset();
                emailForm.querySelectorAll('input').forEach(input => {
                    input.classList.remove('error', 'success', 'checking');
                });
                emailForm.querySelectorAll('.error-message').forEach(el => el.textContent = '');
                document.getElementById('newEmailValidationStatus').textContent = '';
                document.getElementById('newEmailValidationStatus').className = 'validation-status';
            }
            
            // Clear password change form
            const passwordForm = document.getElementById('changePasswordForm');
            if (passwordForm) {
                passwordForm.reset();
                passwordForm.querySelectorAll('input').forEach(input => {
                    input.classList.remove('error', 'success', 'checking');
                });
                passwordForm.querySelectorAll('.error-message').forEach(el => el.textContent = '');
                
                // Reset password requirements display
                const requirements = ['new-req-length', 'new-req-upper', 'new-req-lower', 'new-req-number', 'new-req-special'];
                requirements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = element.textContent.replace('✓', '✗');
                        element.classList.remove('valid');
                        element.classList.add('invalid');
                    }
                });
            }
            
            // Clear delete account form
            const deleteForm = document.getElementById('deleteAccountForm');
            if (deleteForm) {
                deleteForm.reset();
                deleteForm.querySelectorAll('input').forEach(input => {
                    input.classList.remove('error', 'success');
                });
                deleteForm.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            }
        }

        function setupSettingsEventListeners() {
            // Change email form
            const changeEmailForm = document.getElementById('changeEmailForm');
            changeEmailForm.addEventListener('submit', handleChangeEmail);
            
            const newEmailInput = changeEmailForm.querySelector('input[name="newEmail"]');
            newEmailInput.addEventListener('input', handleNewEmailValidation);
            
            // Change password form
            const changePasswordForm = document.getElementById('changePasswordForm');
            changePasswordForm.addEventListener('submit', handleChangePassword);
            
            const newPasswordInput = changePasswordForm.querySelector('input[name="newPassword"]');
            const confirmNewPasswordInput = changePasswordForm.querySelector('input[name="confirmNewPassword"]');
            
            newPasswordInput.addEventListener('input', handleNewPasswordValidation);
            confirmNewPasswordInput.addEventListener('input', handleConfirmNewPasswordValidation);
            
            // Delete account form
            const deleteAccountForm = document.getElementById('deleteAccountForm');
            deleteAccountForm.addEventListener('submit', handleDeleteAccount);
        }

        // Additional functions needed for settings functionality
        async function handleChangeEmail(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const newEmail = formData.get('newEmail').trim();
            const currentPassword = formData.get('currentPassword');
            
            // Clear previous errors
            form.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            form.querySelectorAll('input').forEach(input => input.classList.remove('error'));
            
            // Show loading state
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                // Validate inputs
                if (!newEmail || !currentPassword) {
                    throw new Error('Please fill in all fields');
                }
                
                // Verify current password
                if (!currentUser || !currentUser.password || currentUser.password !== currentPassword) {
                    document.getElementById('currentPasswordError').textContent = 'Current password is incorrect';
                    form.querySelector('input[name="currentPassword"]').classList.add('error');
                    throw new Error('Invalid password');
                }
                
                // Validate new email
                if (!isValidEmail(newEmail)) {
                    document.getElementById('changeEmailError').textContent = 'Please enter a valid email address';
                    form.querySelector('input[name="newEmail"]').classList.add('error');
                    throw new Error('Invalid email format');
                }
                
                if (newEmail.toLowerCase() === currentUser.email.toLowerCase()) {
                    document.getElementById('changeEmailError').textContent = 'This is your current email address';
                    form.querySelector('input[name="newEmail"]').classList.add('error');
                    throw new Error('Same email address');
                }
                
                if (isEmailRegistered(newEmail)) {
                    document.getElementById('changeEmailError').textContent = 'This email is already registered';
                    form.querySelector('input[name="newEmail"]').classList.add('error');
                    throw new Error('Email already registered');
                }
                
                // Validate email exists
                const emailExists = await validateEmailExists(newEmail);
                if (!emailExists) {
                    document.getElementById('changeEmailError').textContent = 'Please enter a valid email address from a recognized domain';
                    form.querySelector('input[name="newEmail"]').classList.add('error');
                    throw new Error('Invalid email domain');
                }
                
                // Simulate email update process
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Store old email for reference
                const oldEmail = currentUser.email;
                
                // Update user email in registered users array
                const userIndex = registeredUsers.findIndex(u => u.email === oldEmail);
                if (userIndex !== -1) {
                    registeredUsers[userIndex].email = newEmail.toLowerCase();
                }
                
                // Update current user email
                currentUser.email = newEmail.toLowerCase();
                
                // Update the display
                document.getElementById('currentEmailDisplay').textContent = currentUser.email;
                updateUserInterface();
                
                showNotification(`Email successfully changed from ${oldEmail} to ${newEmail}!`, 'success');
                
                // Clear form inputs
                form.reset();
                
                // Clear validation states
                form.querySelectorAll('input').forEach(input => {
                    input.classList.remove('error', 'success', 'checking');
                });
                
                // Clear validation status
                document.getElementById('newEmailValidationStatus').textContent = '';
                document.getElementById('newEmailValidationStatus').className = 'validation-status';
                
            } catch (error) {
                // Error handling is done above with specific field errors
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        async function handleChangePassword(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const currentPassword = formData.get('currentPassword');
            const newPassword = formData.get('newPassword');
            const confirmNewPassword = formData.get('confirmNewPassword');
            
            // Clear previous errors
            form.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            form.querySelectorAll('input').forEach(input => input.classList.remove('error'));
            
            // Show loading state
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                // Validate inputs
                if (!currentPassword || !newPassword || !confirmNewPassword) {
                    throw new Error('Please fill in all fields');
                }
                
                // Verify current password
                if (!currentUser || !currentUser.password || currentUser.password !== currentPassword) {
                    document.getElementById('currentPasswordChangeError').textContent = 'Current password is incorrect';
                    form.querySelector('input[name="currentPassword"]').classList.add('error');
                    throw new Error('Invalid current password');
                }
                
                // Validate new password
                const passwordValidation = validatePassword(newPassword);
                if (!passwordValidation.isValid) {
                    document.getElementById('newPasswordError').textContent = 'Password must meet all requirements';
                    form.querySelector('input[name="newPassword"]').classList.add('error');
                    throw new Error('Password does not meet requirements');
                }
                
                // Check if passwords match
                if (newPassword !== confirmNewPassword) {
                    document.getElementById('confirmNewPasswordError').textContent = 'Passwords do not match';
                    form.querySelector('input[name="confirmNewPassword"]').classList.add('error');
                    throw new Error('Passwords do not match');
                }
                
                // Check if new password is different from current
                if (newPassword === currentPassword) {
                    document.getElementById('newPasswordError').textContent = 'New password must be different from current password';
                    form.querySelector('input[name="newPassword"]').classList.add('error');
                    throw new Error('Password must be different');
                }
                
                // Simulate password change process
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Update user password in registered users array
                const userIndex = registeredUsers.findIndex(u => u.email === currentUser.email);
                if (userIndex !== -1) {
                    registeredUsers[userIndex].password = newPassword;
                }
                
                // Update current user password
                currentUser.password = newPassword;
                
                showNotification('Password changed successfully!', 'success');
                
                // Clear form inputs
                form.reset();
                
                // Clear validation states
                form.querySelectorAll('input').forEach(input => {
                    input.classList.remove('error', 'success', 'checking');
                });
                
                // Reset password requirements display
                const requirements = ['new-req-length', 'new-req-upper', 'new-req-lower', 'new-req-number', 'new-req-special'];
                requirements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = element.textContent.replace('✓', '✗');
                        element.classList.remove('valid');
                        element.classList.add('invalid');
                    }
                });
                
            } catch (error) {
                // Error handling is done above with specific field errors
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        async function handleDeleteAccount(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const confirmDelete = formData.get('confirmDelete').trim();
            const deletePassword = formData.get('deletePassword');
            
            // Clear previous errors
            form.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            form.querySelectorAll('input').forEach(input => input.classList.remove('error'));
            
            // Show loading state
            setButtonLoading(form.querySelector('button[type="submit"]'), true);
            
            try {
                // Validate inputs
                if (!confirmDelete || !deletePassword) {
                    throw new Error('Please fill in all fields');
                }
                
                // Check confirmation text
                if (confirmDelete !== 'DELETE') {
                    document.getElementById('deleteConfirmError').textContent = 'Please type "DELETE" exactly to confirm';
                    form.querySelector('input[name="confirmDelete"]').classList.add('error');
                    throw new Error('Invalid confirmation');
                }
                
                // Verify password
                if (!currentUser || !currentUser.password || currentUser.password !== deletePassword) {
                    document.getElementById('deletePasswordError').textContent = 'Password is incorrect';
                    form.querySelector('input[name="deletePassword"]').classList.add('error');
                    throw new Error('Invalid password');
                }
                
                // Final confirmation
                if (!confirm('Are you absolutely sure you want to delete your account? This action cannot be undone.')) {
                    // Clear form if user cancels
                    form.reset();
                    form.querySelectorAll('input').forEach(input => {
                        input.classList.remove('error', 'success');
                    });
                    throw new Error('Deletion cancelled');
                }
                
                // Simulate account deletion process
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Remove user from registered users
                registeredUsers = registeredUsers.filter(u => u.email !== currentUser.email);
                
                // Clear current user
                currentUser = null;
                
                // Clear cart
                cart = [];
                updateCartUI();
                
                showNotification('Your account has been permanently deleted.', 'success');
                closeSettingsModal();
                updateUserInterface();
                
            } catch (error) {
                if (error.message === 'Deletion cancelled') {
                    // User cancelled, form is already cleared above
                } else {
                    // Other errors are handled above with specific field errors
                }
            } finally {
                setButtonLoading(form.querySelector('button[type="submit"]'), false);
            }
        }

        let newEmailValidationTimeout;
        async function handleNewEmailValidation(e) {
            const email = e.target.value;
            const statusDiv = document.getElementById('newEmailValidationStatus');
            const errorDiv = document.getElementById('changeEmailError');
            
            // Clear previous timeout
            if (newEmailValidationTimeout) {
                clearTimeout(newEmailValidationTimeout);
            }
            
            // Reset states
            errorDiv.textContent = '';
            e.target.classList.remove('error', 'success', 'checking');
            
            if (!email) {
                statusDiv.textContent = '';
                statusDiv.className = 'validation-status';
                return;
            }
            
            // Check if same as current email
            if (currentUser && email.toLowerCase() === currentUser.email.toLowerCase()) {
                errorDiv.textContent = 'This is your current email address';
                e.target.classList.add('error');
                statusDiv.textContent = '';
                return;
            }
            
            // Basic format validation
            if (!isValidEmail(email)) {
                errorDiv.textContent = 'Please enter a valid email address';
                e.target.classList.add('error');
                statusDiv.textContent = '';
                return;
            }
            
            // Check if already registered
            if (isEmailRegistered(email)) {
                errorDiv.textContent = 'This email is already registered to another account';
                e.target.classList.add('error');
                statusDiv.textContent = '';
                return;
            }
            
            // Show checking status
            statusDiv.textContent = 'Validating email...';
            statusDiv.className = 'validation-status checking';
            e.target.classList.add('checking');
            
            // Debounce validation
            newEmailValidationTimeout = setTimeout(async () => {
                try {
                    const isValid = await validateEmailExists(email);
                    
                    if (isValid) {
                        statusDiv.textContent = '✓ Email is valid';
                        statusDiv.className = 'validation-status valid';
                        e.target.classList.remove('checking');
                        e.target.classList.add('success');
                    } else {
                        errorDiv.textContent = 'Please enter a valid email address from a recognized domain';
                        statusDiv.textContent = '';
                        statusDiv.className = 'validation-status';
                        e.target.classList.remove('checking');
                        e.target.classList.add('error');
                    }
                } catch (error) {
                    errorDiv.textContent = 'Unable to validate email. Please try again.';
                    statusDiv.textContent = '';
                    statusDiv.className = 'validation-status';
                    e.target.classList.remove('checking');
                    e.target.classList.add('error');
                }
            }, 1000);
        }

        function handleNewPasswordValidation(e) {
            const password = e.target.value;
            const validation = validatePassword(password);
            const errorDiv = document.getElementById('newPasswordError');
            
            // Update requirements display
            const requirements = {
                'new-req-length': password.length >= 8,
                'new-req-upper': /[A-Z]/.test(password),
                'new-req-lower': /[a-z]/.test(password),
                'new-req-number': /\d/.test(password),
                'new-req-special': /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };
            
            Object.entries(requirements).forEach(([id, isValid]) => {
                const element = document.getElementById(id);
                if (element) {
                    if (isValid) {
                        element.textContent = element.textContent.replace('✗', '✓');
                        element.classList.add('valid');
                        element.classList.remove('invalid');
                    } else {
                        element.textContent = element.textContent.replace('✓', '✗');
                        element.classList.add('invalid');
                        element.classList.remove('valid');
                    }
                }
            });
            
            // Update input styling
            if (password && validation.isValid) {
                e.target.classList.remove('error');
                e.target.classList.add('success');
                errorDiv.textContent = '';
            } else if (password) {
                e.target.classList.remove('success');
                e.target.classList.add('error');
            } else {
                e.target.classList.remove('error', 'success');
            }
        }

        function handleConfirmNewPasswordValidation(e) {
            const newPasswordInput = document.querySelector('#changePasswordForm input[name="newPassword"]');
            const newPassword = newPasswordInput.value;
            const confirmPassword = e.target.value;
            const errorDiv = document.getElementById('confirmNewPasswordError');
            
            if (!confirmPassword) {
                errorDiv.textContent = '';
                e.target.classList.remove('error', 'success');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                errorDiv.textContent = 'Passwords do not match';
                e.target.classList.add('error');
                e.target.classList.remove('success');
            } else {
                errorDiv.textContent = '';
                e.target.classList.remove('error');
                e.target.classList.add('success');
            }
        }

        function viewProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            showProductDetailModal(product);
        }

        function showProductDetailModal(product) {
            // Create modal overlay
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'product-detail-overlay';
            modalOverlay.innerHTML = `
                <div class="product-detail-modal">
                    <button class="modal-close-btn" onclick="closeProductModal()">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="product-detail-content">
                        <div class="product-detail-left">
                            <div class="product-detail-image">
                                <span style="font-size: 6rem;">${product.icon}</span>
                                <div class="product-detail-badge">${product.badge}</div>
                            </div>
                            
                            <div class="product-detail-gallery">
                                <div class="gallery-thumb active">
                                    <span style="font-size: 2rem;">${product.icon}</span>
                                </div>
                                <div class="gallery-thumb">
                                    <span style="font-size: 2rem;">📷</span>
                                </div>
                                <div class="gallery-thumb">
                                    <span style="font-size: 2rem;">🔍</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="product-detail-right">
                            <div class="product-detail-header">
                                <h1 class="product-detail-title">${product.name}</h1>
                                <div class="product-detail-rating">
                                    <div class="stars">${generateStars(product.rating)}</div>
                                    <span>(${product.rating}) • 127 reviews</span>
                                </div>
                            </div>
                            
                            <div class="product-detail-price">
                                <span class="price-current">${product.price}</span>
                                <span class="price-original">${product.originalPrice}</span>
                                <span class="price-discount">${Math.round((1 - product.price/product.originalPrice) * 100)}% OFF</span>
                            </div>
                            
                            <div class="product-detail-description">
                                <h3>Description</h3>
                                <p>${product.description}</p>
                                <p>This premium ${product.category.replace('-', ' ')} device offers exceptional value for money with cutting-edge features and reliable performance. Perfect for everyday use and professional applications.</p>
                            </div>
                            
                            <div class="product-detail-features">
                                <h3>Key Features</h3>
                                <ul>
                                    ${generateProductFeatures(product)}
                                </ul>
                            </div>
                            
                            <div class="product-detail-specs">
                                <h3>Specifications</h3>
                                <div class="specs-grid">
                                    ${generateProductSpecs(product)}
                                </div>
                            </div>
                            
                            <div class="product-detail-actions">
                                <div class="quantity-selector">
                                    <label>Quantity:</label>
                                    <div class="quantity-controls-detail">
                                        <button type="button" onclick="changeDetailQuantity(-1)">-</button>
                                        <input type="number" id="detailQuantity" value="1" min="1" max="10">
                                        <button type="button" onclick="changeDetailQuantity(1)">+</button>
                                    </div>
                                </div>
                                
                                <button class="btn btn-primary btn-large" onclick="addToCartFromDetail(${product.id})">
                                    <i class="fas fa-shopping-cart"></i>
                                    Add to Cart
                                </button>
                                
                                <button class="btn btn-secondary btn-large" onclick="buyNow(${product.id})">
                                    <i class="fas fa-bolt"></i>
                                    Buy Now
                                </button>
                            </div>
                            
                            <div class="product-detail-info">
                                <div class="info-item">
                                    <i class="fas fa-truck"></i>
                                    <div>
                                        <strong>Free Shipping</strong>
                                        <span>On orders over $50</span>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <i class="fas fa-undo"></i>
                                    <div>
                                        <strong>30-Day Returns</strong>
                                        <span>Hassle-free returns</span>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <i class="fas fa-shield-alt"></i>
                                    <div>
                                        <strong>1 Year Warranty</strong>
                                        <span>Manufacturer warranty</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modalOverlay);
            
            // Show modal with animation
            setTimeout(() => {
                modalOverlay.classList.add('active');
            }, 10);
            
            // Add event listeners
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay) {
                    closeProductModal();
                }
            });
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        function generateProductFeatures(product) {
            const featuresByCategory = {
                smartphones: [
                    'High-resolution camera system',
                    'Fast processor for smooth performance',
                    'Long-lasting battery life',
                    'Premium build quality',
                    'Latest operating system'
                ],
                laptops: [
                    'Powerful processor for multitasking',
                    'Fast SSD storage',
                    'Full HD display',
                    'Lightweight and portable design',
                    'Long battery life'
                ],
                tablets: [
                    'Large high-resolution display',
                    'Lightweight and portable',
                    'All-day battery life',
                    'Fast wireless connectivity',
                    'Intuitive touch interface'
                ],
                audio: [
                    'Premium sound quality',
                    'Comfortable fit for extended use',
                    'Noise cancellation technology',
                    'Wireless connectivity',
                    'Long battery life'
                ],
                accessories: [
                    'Universal compatibility',
                    'Durable construction',
                    'Easy to use',
                    'Compact design',
                    'Reliable performance'
                ],
                gaming: [
                    'High-performance components',
                    'Low latency for competitive gaming',
                    'Ergonomic design',
                    'RGB lighting',
                    'Professional-grade quality'
                ],
                'smart-home': [
                    'Voice control compatible',
                    'Easy setup and installation',
                    'Smart automation features',
                    'Energy efficient',
                    'Remote control via app'
                ],
                wearables: [
                    'Advanced health tracking',
                    'Water resistant design',
                    'Long battery life',
                    'Smartphone compatibility',
                    'Comfortable all-day wear'
                ]
            };
            
            const features = featuresByCategory[product.category] || featuresByCategory.accessories;
            return features.map(feature => `<li>${feature}</li>`).join('');
        }

        function generateProductSpecs(product) {
            const specsByCategory = {
                smartphones: [
                    { label: 'Display', value: '6.1" OLED' },
                    { label: 'Storage', value: '128GB' },
                    { label: 'RAM', value: '8GB' },
                    { label: 'Camera', value: '50MP Main' },
                    { label: 'Battery', value: '4000mAh' },
                    { label: 'OS', value: 'Android 13' }
                ],
                laptops: [
                    { label: 'Processor', value: 'Intel i5 / AMD Ryzen 5' },
                    { label: 'RAM', value: '8GB DDR4' },
                    { label: 'Storage', value: '256GB SSD' },
                    { label: 'Display', value: '15.6" Full HD' },
                    { label: 'Graphics', value: 'Integrated' },
                    { label: 'Weight', value: '3.5 lbs' }
                ],
                tablets: [
                    { label: 'Display', value: '10.1" LCD' },
                    { label: 'Processor', value: 'Octa-core' },
                    { label: 'Storage', value: '64GB' },
                    { label: 'RAM', value: '4GB' },
                    { label: 'Battery', value: '7000mAh' },
                    { label: 'Weight', value: '1.2 lbs' }
                ],
                audio: [
                    { label: 'Driver Size', value: '40mm' },
                    { label: 'Frequency', value: '20Hz-20kHz' },
                    { label: 'Impedance', value: '32Ω' },
                    { label: 'Battery', value: '30 hours' },
                    { label: 'Connectivity', value: 'Bluetooth 5.0' },
                    { label: 'Weight', value: '250g' }
                ],
                accessories: [
                    { label: 'Compatibility', value: 'Universal' },
                    { label: 'Material', value: 'Premium build' },
                    { label: 'Warranty', value: '1 Year' },
                    { label: 'Dimensions', value: 'Compact' },
                    { label: 'Color', value: 'Multiple options' },
                    { label: 'Certification', value: 'CE, FCC' }
                ]
            };
            
            const specs = specsByCategory[product.category] || specsByCategory.accessories;
            return specs.map(spec => `
                <div class="spec-item">
                    <span class="spec-label">${spec.label}:</span>
                    <span class="spec-value">${spec.value}</span>
                </div>
            `).join('');
        }

        function closeProductModal() {
            const modal = document.querySelector('.product-detail-overlay');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => {
                    document.body.removeChild(modal);
                    document.body.style.overflow = '';
                }, 300);
            }
        }

        function changeDetailQuantity(change) {
            const input = document.getElementById('detailQuantity');
            const currentValue = parseInt(input.value);
            const newValue = Math.max(1, Math.min(10, currentValue + change));
            input.value = newValue;
        }

        function addToCartFromDetail(productId) {
            const quantity = parseInt(document.getElementById('detailQuantity').value);
            const product = products.find(p => p.id === productId);
            
            for (let i = 0; i < quantity; i++) {
                addToCart(productId);
            }
            
            showNotification(`${quantity} × ${product.name} added to cart!`, 'success');
        }

        function buyNow(productId) {
            addToCartFromDetail(productId);
            closeProductModal();
            toggleCart();
            
            setTimeout(() => {
                const checkoutBtn = document.querySelector('#cartSidebar button[onclick="proceedToCheckout()"]');
                if (checkoutBtn) {
                    checkoutBtn.style.animation = 'pulse 1s ease-in-out 3';
                }
            }, 500);
        }

        function proceedToCheckout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty! Add some products before checkout.', 'warning');
                return;
            }
            
            if (!currentUser) {
                showNotification('Please login to continue with checkout.', 'warning');
                toggleCart(); // Close cart
                openAuthModal();
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = total * 0.08;
            const finalTotal = total + tax;
            
            // Show processing message
            showNotification('Processing your payment...', 'info');
            
            // Simulate payment processing
            setTimeout(() => {
                showNotification(`Payment successful! Total: ${finalTotal.toFixed(2)}. Thank you for your purchase, ${currentUser.name}!`, 'success');
                cart = [];
                updateCartUI();
                toggleCart();
                
                // Show order confirmation
                setTimeout(() => {
                    showNotification('Order confirmation sent to your email!', 'info');
                }, 2000);
            }, 2000);
        }

        function showNotification(message, type = 'success', duration = null) {
            // Create notification element
            const notification = document.createElement('div');
            
            let bgColor, iconClass;
            switch (type) {
                case 'success':
                    bgColor = 'linear-gradient(45deg, #10b981, #059669)';
                    iconClass = 'fas fa-check-circle';
                    break;
                case 'warning':
                    bgColor = 'linear-gradient(45deg, #f59e0b, #d97706)';
                    iconClass = 'fas fa-exclamation-triangle';
                    break;
                case 'error':
                    bgColor = 'linear-gradient(45deg, #ef4444, #dc2626)';
                    iconClass = 'fas fa-times-circle';
                    break;
                case 'info':
                    bgColor = 'linear-gradient(45deg, #3b82f6, #2563eb)';
                    iconClass = 'fas fa-info-circle';
                    break;
                default:
                    bgColor = 'linear-gradient(45deg, #3b82f6, #2563eb)';
                    iconClass = 'fas fa-info-circle';
            }
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
                z-index: 4000;
                font-weight: 600;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
                border: 1px solid rgba(255, 255, 255, 0.2);
                max-width: 350px;
                display: flex;
                align-items: flex-start;
                gap: 0.75rem;
                margin-bottom: 1rem;
            `;
            
            // Create close button
            const closeBtn = document.createElement('button');
            closeBtn.innerHTML = '<i class="fas fa-times"></i>';
            closeBtn.style.cssText = `
                background: none;
                border: none;
                color: white;
                cursor: pointer;
                padding: 0;
                margin-left: auto;
                font-size: 0.9rem;
                opacity: 0.8;
                transition: opacity 0.3s ease;
                min-width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            closeBtn.addEventListener('click', () => {
                dismissNotification(notification);
            });
            
            closeBtn.addEventListener('mouseenter', () => {
                closeBtn.style.opacity = '1';
            });
            
            closeBtn.addEventListener('mouseleave', () => {
                closeBtn.style.opacity = '0.8';
            });
            
            // Create content container
            const content = document.createElement('div');
            content.style.cssText = `
                display: flex;
                align-items: flex-start;
                gap: 0.5rem;
                flex: 1;
                line-height: 1.4;
            `;
            
            content.innerHTML = `
                <i class="${iconClass}" style="margin-top: 2px; font-size: 0.9rem;"></i>
                <span style="font-size: 0.9rem;">${message}</span>
            `;
            
            notification.appendChild(content);
            notification.appendChild(closeBtn);
            
            // Position notification (stack them if multiple)
            const existingNotifications = document.querySelectorAll('[data-notification]');
            let topOffset = 20;
            existingNotifications.forEach(existing => {
                topOffset += existing.offsetHeight + 10;
            });
            notification.style.top = topOffset + 'px';
            notification.setAttribute('data-notification', 'true');
            
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Auto-hide notification after duration
            const autoDismissTime = duration || Math.max(3000, message.length * 50);
            const timeoutId = setTimeout(() => {
                dismissNotification(notification);
            }, autoDismissTime);
            
            // Store timeout ID so we can cancel it if manually closed
            notification.timeoutId = timeoutId;
        }

        function dismissNotification(notification) {
            if (!notification || !document.body.contains(notification)) return;
            
            // Clear auto-dismiss timeout
            if (notification.timeoutId) {
                clearTimeout(notification.timeoutId);
            }
            
            notification.style.opacity = '0';
            notification.style.transform = 'translateX(100%)';
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                    
                    // Reposition remaining notifications
                    const remainingNotifications = document.querySelectorAll('[data-notification]');
                    let topOffset = 20;
                    remainingNotifications.forEach(existing => {
                        existing.style.top = topOffset + 'px';
                        topOffset += existing.offsetHeight + 10;
                    });
                }
            }, 300);
        }

        // Animate elements on scroll
        function animateOnScroll() {
            const elements = document.querySelectorAll('.product-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });

            elements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(el);
            });
        }

        // Call animation function after products load
        setTimeout(animateOnScroll, 100);
    </script>
</body>
</html>
